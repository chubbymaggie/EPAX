<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>EPAXDeveloperGuide: ElfBinary.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">EPAXDeveloperGuide
   &#160;<span id="projectnumber">0.01</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ElfBinary.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_elf_binary_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="_e_p_a_x_common_internal_8hpp.html">EPAXCommonInternal.hpp</a>&quot;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;Elf/elf.h&quot;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="_binary_8hpp.html">Binary.hpp</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="_elf_binary_8hpp.html">ElfBinary.hpp</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="_function_8hpp.html">Function.hpp</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="_input_file_8hpp.html">InputFile.hpp</a>&quot;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keyword">namespace </span>EPAX {
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="namespace_e_p_a_x_1_1_elf.html">00036</a>     <span class="keyword">namespace </span>Elf {
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">00038</a> <span class="preprocessor">#define EHDR32_ENTRY ((Elf32_Ehdr*)entry)</span>
<a name="l00039"></a><a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define EHDR64_ENTRY ((Elf64_Ehdr*)entry)</span>
<a name="l00040"></a><a class="code" href="_elf_binary_8cpp.html#abd78d0bd3478762602df1232d10d1321">00040</a> <span class="preprocessor"></span><span class="preprocessor">#define SYM32_ENTRY ((Elf32_Sym*)entry)</span>
<a name="l00041"></a><a class="code" href="_elf_binary_8cpp.html#a64f5c655a7547a00865a3102c75abbf1">00041</a> <span class="preprocessor"></span><span class="preprocessor">#define SYM64_ENTRY ((Elf64_Sym*)entry)</span>
<a name="l00042"></a><a class="code" href="_elf_binary_8cpp.html#a824b027d2116797a3dfd9cde0ff56987">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define SHDR32_ENTRY ((Elf32_Shdr*)entry)</span>
<a name="l00043"></a><a class="code" href="_elf_binary_8cpp.html#a69a1f1681babbf982bec2f34e81495bf">00043</a> <span class="preprocessor"></span><span class="preprocessor">#define SHDR64_ENTRY ((Elf64_Shdr*)entry)</span>
<a name="l00044"></a><a class="code" href="_elf_binary_8cpp.html#a4c6cc2a3e7348952337e55693edf021b">00044</a> <span class="preprocessor"></span><span class="preprocessor">#define PHDR32_ENTRY ((Elf32_Phdr*)entry)</span>
<a name="l00045"></a><a class="code" href="_elf_binary_8cpp.html#a2520b959decfd5851eb04a64f47f06fa">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define PHDR64_ENTRY ((Elf64_Phdr*)entry)</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span>
<a name="l00047"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aea424db302d99d3330aa5c6331834a45">00047</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aea424db302d99d3330aa5c6331834a45">ElfBinary::ElfBinary</a>(std::string n)
<a name="l00048"></a>00048             : <a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>(n),
<a name="l00049"></a>00049               fileheader(<a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad060118c2df58d974a9f5526d820c184">INVALID_PTR</a>),
<a name="l00050"></a>00050               foundsections(false), sections(<a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad060118c2df58d974a9f5526d820c184">INVALID_PTR</a>),
<a name="l00051"></a>00051               foundsegments(false), segments(<a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad060118c2df58d974a9f5526d820c184">INVALID_PTR</a>)
<a name="l00052"></a>00052         {
<a name="l00053"></a>00053         }
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ab7e61b25803a678994e693ce134c9389">00055</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ab7e61b25803a678994e693ce134c9389">ElfBinary::~ElfBinary</a>(){
<a name="l00056"></a>00056             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>)){
<a name="l00057"></a>00057                 <span class="keyword">delete</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>;
<a name="l00058"></a>00058             }
<a name="l00059"></a>00059 
<a name="l00060"></a>00060             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>)){
<a name="l00061"></a>00061                 <span class="keywordflow">while</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;size()){
<a name="l00062"></a>00062                     <span class="keyword">delete</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;back();
<a name="l00063"></a>00063                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;pop_back();
<a name="l00064"></a>00064                 }
<a name="l00065"></a>00065                 <span class="keyword">delete</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>;
<a name="l00066"></a>00066             }
<a name="l00067"></a>00067 
<a name="l00068"></a>00068             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a75dbde6b29cdcd5297e18645c165d7d5">segments</a>)){
<a name="l00069"></a>00069                 <span class="keywordflow">while</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a75dbde6b29cdcd5297e18645c165d7d5">segments</a>-&gt;size()){
<a name="l00070"></a>00070                     <span class="keyword">delete</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a75dbde6b29cdcd5297e18645c165d7d5">segments</a>-&gt;back();
<a name="l00071"></a>00071                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a75dbde6b29cdcd5297e18645c165d7d5">segments</a>-&gt;pop_back();
<a name="l00072"></a>00072                 }
<a name="l00073"></a>00073                 <span class="keyword">delete</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a75dbde6b29cdcd5297e18645c165d7d5">segments</a>;
<a name="l00074"></a>00074             }
<a name="l00075"></a>00075 
<a name="l00076"></a>00076         }
<a name="l00077"></a>00077 
<a name="l00078"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae52abd95dd6d7f77d3e6da0e629c86e5">00078</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae52abd95dd6d7f77d3e6da0e629c86e5">ElfBinary::insideTextRange</a>(uint64_t a){
<a name="l00079"></a>00079             <span class="keywordflow">for</span> (std::vector&lt;SectionHeader*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;end(); it++){
<a name="l00080"></a>00080                 <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html">SectionHeader</a>* shdr = (*it);
<a name="l00081"></a>00081                 <span class="keywordflow">if</span> (shdr-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#adf62f9619c5cdbe66524f864db451e26">isText</a>() &amp;&amp; shdr-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#aaeba234d199df23d8be4ab874e6a8bac">inRange</a>(a)){
<a name="l00082"></a>00082                     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00083"></a>00083                 }
<a name="l00084"></a>00084             }
<a name="l00085"></a>00085             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00086"></a>00086         }
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a7cba4b5796d98043e281f46437abb6d9">00088</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a7cba4b5796d98043e281f46437abb6d9">ElfBinary::functionEndAddress</a>(<a class="code" href="class_e_p_a_x_1_1_function.html">Function</a>* f, <a class="code" href="class_e_p_a_x_1_1_function.html">Function</a>* nextf){
<a name="l00089"></a>00089             uint64_t addr = <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ac0e87c1d66cacc61454b23cdc12ff764">INVALID_ADDRESS</a>;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html">ElfSymbol</a>* s = (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html">ElfSymbol</a>*)f-&gt;<a class="code" href="class_e_p_a_x_1_1_symbol_base.html#aab5102b6c977d0e2572dbbc6d182ae00">getSymbol</a>();
<a name="l00092"></a>00092             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(s)){
<a name="l00093"></a>00093                 <span class="keywordflow">if</span> (s-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a92184692a8f808802963e1a7ca9606d7">getSection</a>() &lt; <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;size()){
<a name="l00094"></a>00094                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html">SectionHeader</a>* sh = (*sections)[s-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a92184692a8f808802963e1a7ca9606d7">getSection</a>()];
<a name="l00095"></a>00095                     addr = sh-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a1beecb645d931ff31696e9994f1f0e06">getFileOffset</a>() + sh-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a2d9cd842c34c4075260116f0ab373fa2">getSize</a>();
<a name="l00096"></a>00096                 }
<a name="l00097"></a>00097             }
<a name="l00098"></a>00098             
<a name="l00099"></a>00099             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(nextf)){
<a name="l00100"></a>00100                 <span class="keywordflow">if</span> (nextf-&gt;<a class="code" href="class_e_p_a_x_1_1_file_base.html#a779f2254eef1279f52f372e18bfb75f7">getFileOffset</a>() &lt; addr){
<a name="l00101"></a>00101                     addr = nextf-&gt;<a class="code" href="class_e_p_a_x_1_1_file_base.html#a779f2254eef1279f52f372e18bfb75f7">getFileOffset</a>();
<a name="l00102"></a>00102                 }
<a name="l00103"></a>00103             }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105             <span class="keywordflow">return</span> addr;
<a name="l00106"></a>00106         }
<a name="l00107"></a>00107 
<a name="l00108"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#af4d56ab5e4f25b17f236c1712dd7c2bb">00108</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#af4d56ab5e4f25b17f236c1712dd7c2bb">ElfBinary::getStartAddr</a>(){
<a name="l00109"></a>00109             <span class="keywordflow">return</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#abdf6ca1b4c9bb4e4467ad7467c44730e">getStartAddr</a>();
<a name="l00110"></a>00110         }
<a name="l00111"></a>00111 
<a name="l00112"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a9955c801d73bcc62ce60a884f4d36464">00112</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a9955c801d73bcc62ce60a884f4d36464">ElfBinary::verify</a>(){
<a name="l00113"></a>00113             <span class="keywordflow">return</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a3ca4cd831fa0b4406c0d4864b659c91c">verify</a>();
<a name="l00114"></a>00114         }
<a name="l00115"></a>00115 
<a name="l00116"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a48ca78d2f324eef54c478532d1d38636">00116</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a48ca78d2f324eef54c478532d1d38636">ElfBinary::isARM</a>(){
<a name="l00117"></a>00117             <span class="keywordflow">return</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a7213d758b36fccdb80c7c3068155cdee">isARM</a>();
<a name="l00118"></a>00118         }
<a name="l00119"></a>00119 
<a name="l00120"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa6846ae0eedb4620e26e3b466efec629">00120</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa6846ae0eedb4620e26e3b466efec629">ElfBinary::describe</a>(){
<a name="l00121"></a>00121             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#aeb0eeb9a943fe3382edc7e6b10c3d0d5">describe</a>();
<a name="l00122"></a>00122         }
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary32.html#a745eda06077bee1c3968ac6d8185d86e">00124</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary32.html#a745eda06077bee1c3968ac6d8185d86e">ElfBinary32::ElfBinary32</a>(std::string n)
<a name="l00125"></a>00125             : <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html">ElfBinary</a>(n)
<a name="l00126"></a>00126         {
<a name="l00127"></a>00127             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a> = <span class="keyword">new</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html">FileHeader32</a>(<span class="keyword">this</span>, 0);
<a name="l00128"></a>00128         }
<a name="l00129"></a>00129 
<a name="l00130"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary64.html#a47d6997a1bbad96ade4b7d73533ffffb">00130</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary64.html#a47d6997a1bbad96ade4b7d73533ffffb">ElfBinary64::ElfBinary64</a>(std::string n)
<a name="l00131"></a>00131             : <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html">ElfBinary</a>(n)
<a name="l00132"></a>00132         {
<a name="l00133"></a>00133             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a> = <span class="keyword">new</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html">FileHeader64</a>(<span class="keyword">this</span>, 0);
<a name="l00134"></a>00134         }
<a name="l00135"></a>00135 
<a name="l00136"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a813a2985bd91b6e7640a2221235fdb4e">00136</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a813a2985bd91b6e7640a2221235fdb4e">ElfBinary::is32Bit</a>(){
<a name="l00137"></a>00137             <span class="keywordflow">return</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a2f8cfe8d4567e4aefbeb0717da3f0e9c">getFormat</a>() == <a class="code" href="namespace_e_p_a_x.html#a4be639c006ef14def4708b37ee6dd67daf60db782258907c0e3454e681be52862">BinaryFormat_Elf32</a>);
<a name="l00138"></a>00138         }
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a07de5ed756446ede40d3f1328eedfa0b">00140</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a07de5ed756446ede40d3f1328eedfa0b">ElfBinary::is64Bit</a>(){
<a name="l00141"></a>00141             <span class="keywordflow">return</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a2f8cfe8d4567e4aefbeb0717da3f0e9c">getFormat</a>() == <a class="code" href="namespace_e_p_a_x.html#a4be639c006ef14def4708b37ee6dd67dad53669d0075b37070148384d8e265711">BinaryFormat_Elf64</a>);
<a name="l00142"></a>00142         }
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ac929a0c398ce61c8ac80df79dbb6a1d9">00144</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ac929a0c398ce61c8ac80df79dbb6a1d9">ElfBinary::emit</a>(std::string n){
<a name="l00145"></a>00145             <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a100d6ecdfdd16c810baf2306c066abb9">__do_not_call__</a>;
<a name="l00146"></a>00146         }
<a name="l00147"></a>00147 
<a name="l00148"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#add93e2899e35ec753660479b1aa6969f">00148</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#add93e2899e35ec753660479b1aa6969f">ElfBinary::vaddrToFile</a>(uint64_t v){
<a name="l00149"></a>00149             <span class="keywordflow">for</span> (std::vector&lt;ProgramHeader*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a75dbde6b29cdcd5297e18645c165d7d5">segments</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a75dbde6b29cdcd5297e18645c165d7d5">segments</a>-&gt;end(); it++){
<a name="l00150"></a>00150                 <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html">ProgramHeader</a>* h = (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html">ProgramHeader</a>*)(*it);
<a name="l00151"></a>00151                 <span class="keywordflow">if</span> (h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#ae31e5d8dba8226b42315bcfa28b5d596">isValidVaddr</a>(v)){
<a name="l00152"></a>00152                     <span class="keywordflow">return</span> h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a42aab9c522155567f18175b1f09d4d3c">vaddrToFileaddr</a>(v);
<a name="l00153"></a>00153                 }
<a name="l00154"></a>00154             }
<a name="l00155"></a>00155             <span class="keywordflow">return</span> 0;
<a name="l00156"></a>00156         }
<a name="l00157"></a>00157 
<a name="l00158"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a57b3bc6b92a7964835e424d610523240">00158</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a57b3bc6b92a7964835e424d610523240">ElfBinary::findFunctions</a>(){
<a name="l00159"></a>00159             <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a7b41ef1769db498d904361f6eb56a0eb">EPAXAssert</a>(!<a class="code" href="class_e_p_a_x_1_1_base_binary.html#a3c83e522df1f2d99e5e0f81d7cd36fcc">foundfunctions</a>, <span class="stringliteral">&quot;this function should only be called once per binary&quot;</span>);
<a name="l00160"></a>00160             <span class="keywordflow">if</span> (<a class="code" href="class_e_p_a_x_1_1_base_binary.html#a3c83e522df1f2d99e5e0f81d7cd36fcc">foundfunctions</a>){
<a name="l00161"></a>00161                 <span class="keywordflow">return</span>;
<a name="l00162"></a>00162             }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a393e4e2eeea3224d1b61c6a8412c9da5">findSymbols</a>();
<a name="l00165"></a>00165 
<a name="l00166"></a>00166             <a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a> = <span class="keyword">new</span> std::vector&lt;Function*&gt;();
<a name="l00167"></a>00167             <a class="code" href="class_e_p_a_x_1_1_base_binary.html#a3c83e522df1f2d99e5e0f81d7cd36fcc">foundfunctions</a> = <span class="keyword">true</span>;
<a name="l00168"></a>00168 
<a name="l00169"></a>00169             uint32_t cur = 0;
<a name="l00170"></a>00170             <span class="keywordflow">for</span> (std::vector&lt;SymbolTable*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_base_binary.html#ab2b5f8e146dba5f2f0ff32e34b6712bd">symtabs</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_base_binary.html#ab2b5f8e146dba5f2f0ff32e34b6712bd">symtabs</a>-&gt;end(); it++){
<a name="l00171"></a>00171                 <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol_table.html">ElfSymbolTable</a>* symt = (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol_table.html">ElfSymbolTable</a>*)(*it);
<a name="l00172"></a>00172                 <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; symt-&gt;<a class="code" href="class_e_p_a_x_1_1_symbol_table.html#a229729af626ddb0763a1bff287b68918">countSymbols</a>(); i++){
<a name="l00173"></a>00173                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html">ElfSymbol</a>* s = (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html">ElfSymbol</a>*)symt-&gt;<a class="code" href="class_e_p_a_x_1_1_symbol_table.html#a6a4a90088e81ef66cf665c241b9fa1f0">getSymbol</a>(i);
<a name="l00174"></a>00174                     <span class="keywordflow">if</span> (s-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#ad6142f5f07372bffd2f0b9a482696821">isFunction</a>() &amp;&amp; <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae52abd95dd6d7f77d3e6da0e629c86e5">insideTextRange</a>(s-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a81a2839b65f94ce09a1f65a70bb268e1">getFunctionAddress</a>())){
<a name="l00175"></a>00175                         <a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a>-&gt;push_back(<span class="keyword">new</span> <a class="code" href="class_e_p_a_x_1_1_function.html">Function</a>(<span class="keyword">this</span>, <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#add93e2899e35ec753660479b1aa6969f">vaddrToFile</a>(s-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a81a2839b65f94ce09a1f65a70bb268e1">getFunctionAddress</a>()), s-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a38fb6985ad991affbb10051eac2aa75e">getSize</a>(), s-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a81a2839b65f94ce09a1f65a70bb268e1">getFunctionAddress</a>(), cur, s));
<a name="l00176"></a>00176                         cur++;
<a name="l00177"></a>00177                     }
<a name="l00178"></a>00178                 }
<a name="l00179"></a>00179             }
<a name="l00180"></a>00180 
<a name="l00181"></a>00181             <span class="comment">// TODO: sort functions, then figure out how many bytes till the next function boundary</span>
<a name="l00182"></a>00182             cur = 0;
<a name="l00183"></a>00183             std::sort(<a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a>-&gt;begin(), <a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a>-&gt;end(), <a class="code" href="namespace_e_p_a_x.html#aef55d3382820337f1f2759dca145b428">compareMemory</a>);
<a name="l00184"></a>00184             <span class="keywordflow">for</span> (std::vector&lt;Function*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a>-&gt;end(); it++){
<a name="l00185"></a>00185                 <a class="code" href="class_e_p_a_x_1_1_function.html">Function</a>* f = (*it);
<a name="l00186"></a>00186                 f-&gt;<a class="code" href="class_e_p_a_x_1_1_index_base.html#ae5b590c1e70d98d831c740b0eeca0cb8">setIndex</a>(cur++);
<a name="l00187"></a>00187             }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189             <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; <a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a>-&gt;size(); i++){
<a name="l00190"></a>00190                 <a class="code" href="class_e_p_a_x_1_1_function.html">Function</a>* f = (*functions)[i];
<a name="l00191"></a>00191                 uint64_t end_addr = <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ac0e87c1d66cacc61454b23cdc12ff764">INVALID_ADDRESS</a>;
<a name="l00192"></a>00192                 <a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b = f-&gt;<a class="code" href="class_e_p_a_x_1_1_file_base.html#a2b31d9b96a82c8702aa2e20017039fd4">getBinary</a>();
<a name="l00193"></a>00193                 <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(b)){
<a name="l00194"></a>00194                     end_addr = b-&gt;<a class="code" href="class_e_p_a_x_1_1_base_binary.html#a3ebaa616622aaca98685ece5d59c05d8">functionEndAddress</a>(f, i+1 &lt; <a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a>-&gt;size()? (*functions)[i+1]:<a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad060118c2df58d974a9f5526d820c184">INVALID_PTR</a>);
<a name="l00195"></a>00195                 }
<a name="l00196"></a>00196                 <span class="comment">//EPAXAssert(end_addr != INVALID_ADDRESS, &quot;No end address for function &quot; &lt;&lt; f-&gt;getName() &lt;&lt; &quot; found&quot;);</span>
<a name="l00197"></a>00197                 <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#ac0e87c1d66cacc61454b23cdc12ff764">INVALID_ADDRESS</a> != end_addr){
<a name="l00198"></a>00198                     f-&gt;<a class="code" href="class_e_p_a_x_1_1_memory_base.html#ae39b6d63f7791f5192c9cb9a28b4a218">setMemorySize</a>(end_addr - f-&gt;<a class="code" href="class_e_p_a_x_1_1_file_base.html#a779f2254eef1279f52f372e18bfb75f7">getFileOffset</a>());
<a name="l00199"></a>00199                 }
<a name="l00200"></a>00200             }
<a name="l00201"></a>00201 
<a name="l00202"></a>00202             <span class="keywordflow">for</span> (std::vector&lt;Function*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a>-&gt;end(); it++){
<a name="l00203"></a>00203                 <a class="code" href="class_e_p_a_x_1_1_function.html">Function</a>* f = (*it);
<a name="l00204"></a>00204                 f-&gt;<a class="code" href="class_e_p_a_x_1_1_function.html#a0388e0d1e3953da9e259711c4352c146">disassemble</a>();
<a name="l00205"></a>00205             }
<a name="l00206"></a>00206 
<a name="l00207"></a>00207             <span class="comment">//printFunctions();</span>
<a name="l00208"></a>00208         }
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aac1eb1e8571502f6005ac54d4b6e5920">00210</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aac1eb1e8571502f6005ac54d4b6e5920">ElfBinary::printFunctions</a>(std::ostream&amp; stream){
<a name="l00211"></a>00211             stream &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a90dc3f3ee970394e0080300526390a84">ENDL</a>;
<a name="l00212"></a>00212             stream &lt;&lt; <span class="stringliteral">&quot;Printing all functions in &quot;</span> &lt;&lt; <a class="code" href="class_e_p_a_x_1_1_name_base.html#ac45bad0887b6a3283cc76047f91f7708">getName</a>() &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a90dc3f3ee970394e0080300526390a84">ENDL</a>;
<a name="l00213"></a>00213             <a class="code" href="class_e_p_a_x_1_1_function.html#acf8e6e84f93e87bab13edc2c03929425">Function::printHeader</a>();
<a name="l00214"></a>00214             <span class="keywordflow">for</span> (std::vector&lt;Function*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_base_binary.html#aa26b782267daf58809b05047ff677a3e">functions</a>-&gt;end(); it++){
<a name="l00215"></a>00215                 <a class="code" href="class_e_p_a_x_1_1_function.html">Function</a>* f = (*it);
<a name="l00216"></a>00216                 f-&gt;<a class="code" href="class_e_p_a_x_1_1_function.html#a82cd9c2c9b4210f2c189e60f13445b77">print</a>(stream);
<a name="l00217"></a>00217             }
<a name="l00218"></a>00218         }
<a name="l00219"></a>00219 
<a name="l00220"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae14d70c8ea2a3e9eaa1be65661c56efb">00220</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html">ElfStringTable</a>* <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae14d70c8ea2a3e9eaa1be65661c56efb">ElfBinary::findStringtable</a>(uint32_t i){
<a name="l00221"></a>00221             <span class="keywordflow">for</span> (std::vector&lt;StringTable*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_base_binary.html#a48e7fd1954b46f6bf7885dd70ae0ac78">strtabs</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_base_binary.html#a48e7fd1954b46f6bf7885dd70ae0ac78">strtabs</a>-&gt;end(); it++){
<a name="l00222"></a>00222                 <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html">ElfStringTable</a>* s = (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html">ElfStringTable</a>*)(*it);
<a name="l00223"></a>00223                 <span class="keywordflow">if</span> (s-&gt;<a class="code" href="class_e_p_a_x_1_1_index_base.html#a6115276ca197b32637ed030b7afdc58e">getIndex</a>() == i){
<a name="l00224"></a>00224                     <span class="keywordflow">return</span> s;
<a name="l00225"></a>00225                 }
<a name="l00226"></a>00226             }            
<a name="l00227"></a>00227             <span class="keywordflow">return</span> <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad060118c2df58d974a9f5526d820c184">INVALID_PTR</a>;
<a name="l00228"></a>00228         }
<a name="l00229"></a>00229 
<a name="l00230"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a393e4e2eeea3224d1b61c6a8412c9da5">00230</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a393e4e2eeea3224d1b61c6a8412c9da5">ElfBinary::findSymbols</a>(){
<a name="l00231"></a>00231             <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a7b41ef1769db498d904361f6eb56a0eb">EPAXAssert</a>(!<a class="code" href="class_e_p_a_x_1_1_base_binary.html#a941c0d2bd1b8fa811d8a516c603685af">foundsymbols</a>, <span class="stringliteral">&quot;this function should only be called once per binary&quot;</span>);
<a name="l00232"></a>00232             <span class="keywordflow">if</span> (<a class="code" href="class_e_p_a_x_1_1_base_binary.html#a941c0d2bd1b8fa811d8a516c603685af">foundsymbols</a>){
<a name="l00233"></a>00233                 <span class="keywordflow">return</span>;
<a name="l00234"></a>00234             }
<a name="l00235"></a>00235 
<a name="l00236"></a>00236             <a class="code" href="class_e_p_a_x_1_1_base_binary.html#ab2b5f8e146dba5f2f0ff32e34b6712bd">symtabs</a> = <span class="keyword">new</span> std::vector&lt;SymbolTable*&gt;();
<a name="l00237"></a>00237             <a class="code" href="class_e_p_a_x_1_1_base_binary.html#a48e7fd1954b46f6bf7885dd70ae0ac78">strtabs</a> = <span class="keyword">new</span> std::vector&lt;StringTable*&gt;();
<a name="l00238"></a>00238             <a class="code" href="class_e_p_a_x_1_1_base_binary.html#a941c0d2bd1b8fa811d8a516c603685af">foundsymbols</a> = <span class="keyword">true</span>;
<a name="l00239"></a>00239 
<a name="l00240"></a>00240             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ad4a57cb23543cb8b37d9b4fa61f07a0c">findSections</a>();
<a name="l00241"></a>00241             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae357dea8fe42fff9b8ae321dc94b0503">findSegments</a>();
<a name="l00242"></a>00242 
<a name="l00243"></a>00243             <span class="comment">// find string tables</span>
<a name="l00244"></a>00244             uint32_t cur = 0;
<a name="l00245"></a>00245             <span class="keywordflow">for</span> (std::vector&lt;SectionHeader*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;end(); it++){
<a name="l00246"></a>00246                 <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html">SectionHeader</a>* h = (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html">SectionHeader</a>*)(*it);
<a name="l00247"></a>00247                 <span class="keywordflow">if</span> (h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a6d66cd345b7cb520d758ae04c50164e1">isString</a>()){
<a name="l00248"></a>00248                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html">ElfStringTable</a>* st = <span class="keyword">new</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html">ElfStringTable</a>(<span class="keyword">this</span>, h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a1beecb645d931ff31696e9994f1f0e06">getFileOffset</a>(), h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a2d9cd842c34c4075260116f0ab373fa2">getSize</a>(), h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a34bc5ee9fc05b1780e8cca68828bfc23">getVirtAddr</a>(), h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a2d9cd842c34c4075260116f0ab373fa2">getSize</a>(), cur, h-&gt;<a class="code" href="class_e_p_a_x_1_1_name_base.html#ac45bad0887b6a3283cc76047f91f7708">getName</a>());
<a name="l00249"></a>00249                     <span class="comment">//st-&gt;print();</span>
<a name="l00250"></a>00250                     strtabs-&gt;push_back(st);
<a name="l00251"></a>00251                 }
<a name="l00252"></a>00252                 cur++;
<a name="l00253"></a>00253             }
<a name="l00254"></a>00254 
<a name="l00255"></a>00255             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html">ElfStringTable</a>* shdrtab = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae14d70c8ea2a3e9eaa1be65661c56efb">findStringtable</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#aa1d63391748e17afd6ee45c9124d3cc1">getShdrStringIndex</a>());
<a name="l00256"></a>00256             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(shdrtab)){
<a name="l00257"></a>00257                 <span class="keywordflow">for</span> (std::vector&lt;SectionHeader*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;end(); it++){
<a name="l00258"></a>00258                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html">SectionHeader</a>* h = (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html">SectionHeader</a>*)(*it);
<a name="l00259"></a>00259                     h-&gt;<a class="code" href="class_e_p_a_x_1_1_name_base.html#a0249989dc06f3563cdee08435856d15d">setName</a>(shdrtab-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html#a5090981e577dceb27e8dd6c63f1992ba">getStringAt</a>(h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#aac92cdabd70a208e45ff0b6920bee3e6">getNameIndex</a>()));
<a name="l00260"></a>00260                 }
<a name="l00261"></a>00261             }
<a name="l00262"></a>00262             <span class="comment">//printSections();</span>
<a name="l00263"></a>00263 
<a name="l00264"></a>00264             <span class="comment">// find symbol tables</span>
<a name="l00265"></a>00265             cur = 0;
<a name="l00266"></a>00266             <span class="keywordflow">for</span> (std::vector&lt;SectionHeader*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;end(); it++){
<a name="l00267"></a>00267                 <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html">SectionHeader</a>* h = (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html">SectionHeader</a>*)(*it);
<a name="l00268"></a>00268                 <span class="keywordflow">if</span> (h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a9320f92c5158659c148ee6f197b0cd70">isSymbol</a>()){
<a name="l00269"></a>00269                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html">ElfStringTable</a>* st = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae14d70c8ea2a3e9eaa1be65661c56efb">findStringtable</a>(h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a035451e10f87faae8d772f8fda9e42d0">getSectionLink</a>());
<a name="l00270"></a>00270 
<a name="l00271"></a>00271                     <a class="code" href="class_e_p_a_x_1_1_base_binary.html#ab2b5f8e146dba5f2f0ff32e34b6712bd">symtabs</a>-&gt;push_back(<span class="keyword">new</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol_table.html">ElfSymbolTable</a>(<span class="keyword">this</span>, h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a1beecb645d931ff31696e9994f1f0e06">getFileOffset</a>(), h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a2d9cd842c34c4075260116f0ab373fa2">getSize</a>(), h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a34bc5ee9fc05b1780e8cca68828bfc23">getVirtAddr</a>(), h-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a2d9cd842c34c4075260116f0ab373fa2">getSize</a>(), cur, h-&gt;<a class="code" href="class_e_p_a_x_1_1_name_base.html#ac45bad0887b6a3283cc76047f91f7708">getName</a>(), st));
<a name="l00272"></a>00272                     <span class="comment">//symtabs-&gt;back()-&gt;print();</span>
<a name="l00273"></a>00273                 }
<a name="l00274"></a>00274                 cur++;
<a name="l00275"></a>00275             }
<a name="l00276"></a>00276         }
<a name="l00277"></a>00277 
<a name="l00278"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ad4a57cb23543cb8b37d9b4fa61f07a0c">00278</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ad4a57cb23543cb8b37d9b4fa61f07a0c">ElfBinary::findSections</a>(){
<a name="l00279"></a>00279             <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a7b41ef1769db498d904361f6eb56a0eb">EPAXAssert</a>(!<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a0fff68c4ab05d176acf716fc878a20ab">foundsections</a>, <span class="stringliteral">&quot;this function should only be called once per binary&quot;</span>);
<a name="l00280"></a>00280             <span class="keywordflow">if</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a0fff68c4ab05d176acf716fc878a20ab">foundsections</a>){
<a name="l00281"></a>00281                 <span class="keywordflow">return</span>;
<a name="l00282"></a>00282             }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a> = <span class="keyword">new</span> std::vector&lt;SectionHeader*&gt;();
<a name="l00285"></a>00285             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a0fff68c4ab05d176acf716fc878a20ab">foundsections</a> = <span class="keyword">true</span>;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287             uint64_t off = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a465040eb608f51272cb889e4fd0c61f1">getSecTableOffset</a>();
<a name="l00288"></a>00288             uint32_t cnt = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a80f2c4f1a3a4caee7bf6b9b6b7d20d92">getSectionCount</a>();
<a name="l00289"></a>00289             uint64_t sz = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a52a8d42476216d7946039581f570958f">getShdrSize</a>();
<a name="l00290"></a>00290             <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; cnt; i++){
<a name="l00291"></a>00291                 <span class="keywordflow">if</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a813a2985bd91b6e7640a2221235fdb4e">is32Bit</a>()){
<a name="l00292"></a>00292                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;push_back(<span class="keyword">new</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html">SectionHeader32</a>(<span class="keyword">this</span>, off + (i * sz), sz, i));
<a name="l00293"></a>00293                 } <span class="keywordflow">else</span> {
<a name="l00294"></a>00294                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;push_back(<span class="keyword">new</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html">SectionHeader64</a>(<span class="keyword">this</span>, off + (i * sz), sz, i));
<a name="l00295"></a>00295                 }
<a name="l00296"></a>00296             }
<a name="l00297"></a>00297         }
<a name="l00298"></a>00298 
<a name="l00299"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae357dea8fe42fff9b8ae321dc94b0503">00299</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae357dea8fe42fff9b8ae321dc94b0503">ElfBinary::findSegments</a>(){
<a name="l00300"></a>00300             <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a7b41ef1769db498d904361f6eb56a0eb">EPAXAssert</a>(!<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a07d9f4abb56b2522a17f6db39373a53a">foundsegments</a>, <span class="stringliteral">&quot;this function should only be called once per binary&quot;</span>);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302             <span class="keywordflow">if</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a07d9f4abb56b2522a17f6db39373a53a">foundsegments</a>){
<a name="l00303"></a>00303                 <span class="keywordflow">return</span>;
<a name="l00304"></a>00304             }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a75dbde6b29cdcd5297e18645c165d7d5">segments</a> = <span class="keyword">new</span> std::vector&lt;ProgramHeader*&gt;();
<a name="l00307"></a>00307             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a07d9f4abb56b2522a17f6db39373a53a">foundsegments</a> = <span class="keyword">true</span>;
<a name="l00308"></a>00308 
<a name="l00309"></a>00309             uint64_t off = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a428d1229cb7324696436d62b8c099239">getSegTableOffset</a>();
<a name="l00310"></a>00310             uint32_t cnt = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a016aee53224e8350e3b8452b1525aad5">getSegmentCount</a>();
<a name="l00311"></a>00311             uint64_t sz = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a6d180c7702995629f962abd1cce29e2d">getPhdrSize</a>();
<a name="l00312"></a>00312             <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; cnt; i++){
<a name="l00313"></a>00313                 <span class="keywordflow">if</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a813a2985bd91b6e7640a2221235fdb4e">is32Bit</a>()){
<a name="l00314"></a>00314                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a75dbde6b29cdcd5297e18645c165d7d5">segments</a>-&gt;push_back(<span class="keyword">new</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html">ProgramHeader32</a>(<span class="keyword">this</span>, off + (i * sz), sz, i));
<a name="l00315"></a>00315                 } <span class="keywordflow">else</span> {
<a name="l00316"></a>00316                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a75dbde6b29cdcd5297e18645c165d7d5">segments</a>-&gt;push_back(<span class="keyword">new</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html">ProgramHeader64</a>(<span class="keyword">this</span>, off + (i * sz), sz, i));
<a name="l00317"></a>00317                 }
<a name="l00318"></a>00318             }
<a name="l00319"></a>00319         }
<a name="l00320"></a>00320 
<a name="l00321"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a17ca2c27f8cf31a488aaee78b7314ec0">00321</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a17ca2c27f8cf31a488aaee78b7314ec0">FileHeader::FileHeader</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint64_t s)
<a name="l00322"></a>00322             : <a class="code" href="class_e_p_a_x_1_1_file_base.html">FileBase</a>(b, 0, s),
<a name="l00323"></a>00323               entry(<a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad060118c2df58d974a9f5526d820c184">INVALID_PTR</a>)
<a name="l00324"></a>00324         {
<a name="l00325"></a>00325         }
<a name="l00326"></a>00326 
<a name="l00327"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a3b9e79ac6ed14a656537ed57f1bb1235">00327</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a3b9e79ac6ed14a656537ed57f1bb1235">FileHeader::~FileHeader</a>(){
<a name="l00328"></a>00328             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a7c2db25209f5833010086dcfe200e67e">entry</a>)){
<a name="l00329"></a>00329                 <span class="keyword">delete</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a7c2db25209f5833010086dcfe200e67e">entry</a>;
<a name="l00330"></a>00330             }
<a name="l00331"></a>00331         }
<a name="l00332"></a>00332 
<a name="l00333"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a8d5c87c8f17e8e6666fde733f9267bae">00333</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a8d5c87c8f17e8e6666fde733f9267bae">FileHeader32::getSecTableOffset</a>(){
<a name="l00334"></a>00334             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_shoff;
<a name="l00335"></a>00335         }
<a name="l00336"></a>00336 
<a name="l00337"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#ab4bf35526aa8997cdacbe51f401e15a2">00337</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#ab4bf35526aa8997cdacbe51f401e15a2">FileHeader64::getSecTableOffset</a>(){
<a name="l00338"></a>00338             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_shoff;
<a name="l00339"></a>00339         }
<a name="l00340"></a>00340 
<a name="l00341"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a0ed67a18b9abbe58cd2527e4c67d04e6">00341</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a0ed67a18b9abbe58cd2527e4c67d04e6">FileHeader32::getShdrSize</a>(){
<a name="l00342"></a>00342             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_shentsize;
<a name="l00343"></a>00343         }
<a name="l00344"></a>00344 
<a name="l00345"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#ad4c76f6ef875eccd6e453c61736d7e40">00345</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#ad4c76f6ef875eccd6e453c61736d7e40">FileHeader64::getShdrSize</a>(){
<a name="l00346"></a>00346             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_shentsize;
<a name="l00347"></a>00347         }
<a name="l00348"></a>00348 
<a name="l00349"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a726775497585b20e7b5bfcf523492824">00349</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a726775497585b20e7b5bfcf523492824">FileHeader32::getSegTableOffset</a>(){
<a name="l00350"></a>00350             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_phoff;
<a name="l00351"></a>00351         }
<a name="l00352"></a>00352 
<a name="l00353"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#ad05c5e3abb06032413b058f5db1f3f9c">00353</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#ad05c5e3abb06032413b058f5db1f3f9c">FileHeader64::getSegTableOffset</a>(){
<a name="l00354"></a>00354             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_phoff;
<a name="l00355"></a>00355         }
<a name="l00356"></a>00356 
<a name="l00357"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#ac888b12b41b187273440a028e1b704ca">00357</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#ac888b12b41b187273440a028e1b704ca">FileHeader32::getPhdrSize</a>(){
<a name="l00358"></a>00358             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_phentsize;
<a name="l00359"></a>00359         }
<a name="l00360"></a>00360 
<a name="l00361"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a389cfa8997b78c7da91bfd980ad61a94">00361</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a389cfa8997b78c7da91bfd980ad61a94">FileHeader64::getPhdrSize</a>(){
<a name="l00362"></a>00362             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_phentsize;
<a name="l00363"></a>00363         }
<a name="l00364"></a>00364 
<a name="l00365"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a06e25aa5ff7df704d070abaa8ba3c1aa">00365</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a06e25aa5ff7df704d070abaa8ba3c1aa">FileHeader32::getShdrStringIndex</a>(){
<a name="l00366"></a>00366             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_shstrndx;
<a name="l00367"></a>00367         }
<a name="l00368"></a>00368 
<a name="l00369"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a1e776b6ef8858287951a39a15626a6da">00369</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a1e776b6ef8858287951a39a15626a6da">FileHeader64::getShdrStringIndex</a>(){
<a name="l00370"></a>00370             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_shstrndx;
<a name="l00371"></a>00371         }
<a name="l00372"></a>00372 
<a name="l00373"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#ac1dd93429930f0a1f5991cb6270a383e">00373</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#ac1dd93429930f0a1f5991cb6270a383e">FileHeader32::getSectionCount</a>(){
<a name="l00374"></a>00374             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_shnum;
<a name="l00375"></a>00375         }
<a name="l00376"></a>00376 
<a name="l00377"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a525b2d31bb8ad212c197172006cd8b90">00377</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a525b2d31bb8ad212c197172006cd8b90">FileHeader64::getSectionCount</a>(){
<a name="l00378"></a>00378             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_shnum;
<a name="l00379"></a>00379         }
<a name="l00380"></a>00380 
<a name="l00381"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#ac38fc67d4991960a64e43418355847dc">00381</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#ac38fc67d4991960a64e43418355847dc">FileHeader32::getSegmentCount</a>(){
<a name="l00382"></a>00382             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_phnum;
<a name="l00383"></a>00383         }
<a name="l00384"></a>00384 
<a name="l00385"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#af0e3dc9b8ae0832bd9a24d2c72e09011">00385</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#af0e3dc9b8ae0832bd9a24d2c72e09011">FileHeader64::getSegmentCount</a>(){
<a name="l00386"></a>00386             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_phnum;
<a name="l00387"></a>00387         }
<a name="l00388"></a>00388 
<a name="l00389"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#af3a51f4aeb49bc78ac18cbb3e8931a5a">00389</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#af3a51f4aeb49bc78ac18cbb3e8931a5a">FileHeader32::getFileType</a>(){
<a name="l00390"></a>00390             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_type;
<a name="l00391"></a>00391         }
<a name="l00392"></a>00392 
<a name="l00393"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a84696d5ac94bd884141c4306025b8ba4">00393</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a84696d5ac94bd884141c4306025b8ba4">FileHeader64::getFileType</a>(){
<a name="l00394"></a>00394             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_type;
<a name="l00395"></a>00395         }
<a name="l00396"></a>00396 
<a name="l00397"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#abffac5321d1935c5a829715f5d4dbd63">00397</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#abffac5321d1935c5a829715f5d4dbd63">FileHeader32::FileHeader32</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o)
<a name="l00398"></a>00398             : <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html">FileHeader</a>(b, o, sizeof(Elf32_Ehdr))
<a name="l00399"></a>00399         {
<a name="l00400"></a>00400             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a7c2db25209f5833010086dcfe200e67e">entry</a> = (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#a17755bdd71c02e656c667b16de61dd7b">rawbyte_t</a>*)<span class="keyword">new</span> Elf32_Ehdr();
<a name="l00401"></a>00401             <a class="code" href="class_e_p_a_x_1_1_file_base.html#a996b93e64d317be72461c20089a1e91a">getInputFile</a>()-&gt;<a class="code" href="class_e_p_a_x_1_1_input_file.html#a4b7b6d515479e8d3006041a34f15b526">getBytes</a>(o, <a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>(), <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a7c2db25209f5833010086dcfe200e67e">entry</a>);
<a name="l00402"></a>00402         }
<a name="l00403"></a>00403 
<a name="l00404"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a00cf5857d7fb0d99a29da523667b3561">00404</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a00cf5857d7fb0d99a29da523667b3561">FileHeader64::FileHeader64</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o)
<a name="l00405"></a>00405             : <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html">FileHeader</a>(b, o, sizeof(Elf64_Ehdr))
<a name="l00406"></a>00406         {
<a name="l00407"></a>00407             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a7c2db25209f5833010086dcfe200e67e">entry</a> = (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#a17755bdd71c02e656c667b16de61dd7b">rawbyte_t</a>*)<span class="keyword">new</span> Elf64_Ehdr();
<a name="l00408"></a>00408             <a class="code" href="class_e_p_a_x_1_1_file_base.html#a996b93e64d317be72461c20089a1e91a">getInputFile</a>()-&gt;<a class="code" href="class_e_p_a_x_1_1_input_file.html#a4b7b6d515479e8d3006041a34f15b526">getBytes</a>(o, <a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>(), <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a7c2db25209f5833010086dcfe200e67e">entry</a>);
<a name="l00409"></a>00409         }
<a name="l00410"></a>00410 
<a name="l00411"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#ab8a7bf656d86963f9324b2c3686090e1">00411</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#ab8a7bf656d86963f9324b2c3686090e1">FileHeader32::getStartAddr</a>(){
<a name="l00412"></a>00412             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_entry;
<a name="l00413"></a>00413         }
<a name="l00414"></a>00414 
<a name="l00415"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a0d5fb6bb80415565bec58de93526a2ea">00415</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a0d5fb6bb80415565bec58de93526a2ea">FileHeader64::getStartAddr</a>(){
<a name="l00416"></a>00416             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_entry;
<a name="l00417"></a>00417         }
<a name="l00418"></a>00418 
<a name="l00419"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a39dbffddc4e4503da772ebcd66c9c760">00419</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a39dbffddc4e4503da772ebcd66c9c760">FileHeader32::verify</a>(){
<a name="l00420"></a>00420             <span class="keywordflow">if</span> (<a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_ident[EI_MAG0] == ELFMAG0 &amp;&amp;
<a name="l00421"></a>00421                 <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_ident[EI_MAG1] == ELFMAG1 &amp;&amp;
<a name="l00422"></a>00422                 <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_ident[EI_MAG2] == ELFMAG2 &amp;&amp;
<a name="l00423"></a>00423                 <a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_ident[EI_MAG3] == ELFMAG3){
<a name="l00424"></a>00424 
<a name="l00425"></a>00425                 <span class="keywordflow">if</span> (<a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_ident[EI_CLASS] == ELFCLASS32){
<a name="l00426"></a>00426                     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00427"></a>00427                 }
<a name="l00428"></a>00428             }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00431"></a>00431         }
<a name="l00432"></a>00432 
<a name="l00433"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a6a94d18eaee683c6bbe05f3b57f08efc">00433</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a6a94d18eaee683c6bbe05f3b57f08efc">FileHeader64::verify</a>(){
<a name="l00434"></a>00434             <span class="keywordflow">if</span> (<a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_ident[EI_MAG0] == ELFMAG0 &amp;&amp;
<a name="l00435"></a>00435                 <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_ident[EI_MAG1] == ELFMAG1 &amp;&amp;
<a name="l00436"></a>00436                 <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_ident[EI_MAG2] == ELFMAG2 &amp;&amp;
<a name="l00437"></a>00437                 <a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_ident[EI_MAG3] == ELFMAG3){
<a name="l00438"></a>00438 
<a name="l00439"></a>00439                 <span class="keywordflow">if</span> (<a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_ident[EI_CLASS] == ELFCLASS64){
<a name="l00440"></a>00440                     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00441"></a>00441                 }
<a name="l00442"></a>00442             }
<a name="l00443"></a>00443 
<a name="l00444"></a>00444             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00445"></a>00445         }
<a name="l00446"></a>00446 
<a name="l00447"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#af3918b11e74da5f92738df8c70c34258">00447</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#af3918b11e74da5f92738df8c70c34258">FileHeader32::isARM</a>(){
<a name="l00448"></a>00448             <span class="keywordflow">if</span> (<a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_machine == EM_ARM){
<a name="l00449"></a>00449                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00450"></a>00450             }
<a name="l00451"></a>00451         }
<a name="l00452"></a>00452 
<a name="l00453"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a6d992697b0003b0c63f9e9b6271de94a">00453</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a6d992697b0003b0c63f9e9b6271de94a">FileHeader64::isARM</a>(){
<a name="l00454"></a>00454             <span class="comment">// TODO: have a good idea, but not totally sure what ARM64 looks like here</span>
<a name="l00455"></a>00455             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00456"></a>00456         }
<a name="l00457"></a>00457 
<a name="l00458"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a683bf66639d6fb4c4d9e9904a563494e">00458</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#a683bf66639d6fb4c4d9e9904a563494e">ElfBinary::isExecutable</a>(){
<a name="l00459"></a>00459             <span class="keywordflow">return</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#aa0f3e41ca81ccff7704a1a25d2ec3a45">fileheader</a>-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#ae36441d44c2fba9f42709566823b7d08">getFileType</a>() == ET_EXEC);
<a name="l00460"></a>00460         }
<a name="l00461"></a>00461 
<a name="l00462"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#aeb0eeb9a943fe3382edc7e6b10c3d0d5">00462</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#aeb0eeb9a943fe3382edc7e6b10c3d0d5">FileHeader::describe</a>(){
<a name="l00463"></a>00463             <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a4ae2ad536d683dc6eeb730de19823b34">EPAXOut</a> &lt;&lt; <span class="stringliteral">&quot;format=elf&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a>;
<a name="l00464"></a>00464         }
<a name="l00465"></a>00465 
<a name="l00466"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a08520331febff683d5090d71ea762367">00466</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a08520331febff683d5090d71ea762367">FileHeader::describeISA</a>(uint32_t ctype){
<a name="l00467"></a>00467             <span class="keywordflow">switch</span>(ctype){
<a name="l00468"></a>00468 <span class="preprocessor">#define CASE(__typ__) case EM_ ## __typ__: std::cout &lt;&lt; &quot;isa=&quot; &lt;&lt; #__typ__ ; break</span>
<a name="l00469"></a>00469 <span class="preprocessor"></span>                <a class="code" href="_elf_binary_8cpp.html#abce2a449151634d02cb08a333b9c5cc0">CASE</a>(SPARC);
<a name="l00470"></a>00470                 <a class="code" href="_elf_binary_8cpp.html#abce2a449151634d02cb08a333b9c5cc0">CASE</a>(386);
<a name="l00471"></a>00471                 <a class="code" href="_elf_binary_8cpp.html#abce2a449151634d02cb08a333b9c5cc0">CASE</a>(MIPS);
<a name="l00472"></a>00472                 <a class="code" href="_elf_binary_8cpp.html#abce2a449151634d02cb08a333b9c5cc0">CASE</a>(PPC);
<a name="l00473"></a>00473                 <a class="code" href="_elf_binary_8cpp.html#abce2a449151634d02cb08a333b9c5cc0">CASE</a>(PPC64);
<a name="l00474"></a>00474                 <a class="code" href="_elf_binary_8cpp.html#abce2a449151634d02cb08a333b9c5cc0">CASE</a>(ARM);
<a name="l00475"></a>00475                 <a class="code" href="_elf_binary_8cpp.html#abce2a449151634d02cb08a333b9c5cc0">CASE</a>(IA_64);
<a name="l00476"></a>00476                 <a class="code" href="_elf_binary_8cpp.html#abce2a449151634d02cb08a333b9c5cc0">CASE</a>(X86_64);
<a name="l00477"></a>00477                 <a class="code" href="_elf_binary_8cpp.html#abce2a449151634d02cb08a333b9c5cc0">CASE</a>(VAX);
<a name="l00478"></a>00478             <span class="keywordflow">default</span>:
<a name="l00479"></a>00479                 std::cout &lt;&lt; <span class="stringliteral">&quot;isa=unknown&quot;</span>;
<a name="l00480"></a>00480             }
<a name="l00481"></a>00481             std::cout &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a90dc3f3ee970394e0080300526390a84">ENDL</a>;
<a name="l00482"></a>00482         }
<a name="l00483"></a>00483 
<a name="l00484"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a85d8cd834a2410f5f51b8a92ca499058">00484</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a85d8cd834a2410f5f51b8a92ca499058">FileHeader32::describe</a>(){
<a name="l00485"></a>00485             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header32.html#a85d8cd834a2410f5f51b8a92ca499058">FileHeader::describe</a>();
<a name="l00486"></a>00486             std::cout &lt;&lt; <span class="stringliteral">&quot;bits=32&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a>;
<a name="l00487"></a>00487             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a08520331febff683d5090d71ea762367">FileHeader::describeISA</a>(<a class="code" href="_elf_binary_8cpp.html#a09ade31a9390d6ff4843f4d0eab4fa39">EHDR32_ENTRY</a>-&gt;e_machine);
<a name="l00488"></a>00488         }
<a name="l00489"></a>00489 
<a name="l00490"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a121602d4ffb4f401b59cdb63303fc6c4">00490</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a121602d4ffb4f401b59cdb63303fc6c4">FileHeader64::describe</a>(){
<a name="l00491"></a>00491             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header64.html#a121602d4ffb4f401b59cdb63303fc6c4">FileHeader::describe</a>();
<a name="l00492"></a>00492             std::cout &lt;&lt; <span class="stringliteral">&quot;bits=64&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a>;
<a name="l00493"></a>00493             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_file_header.html#a08520331febff683d5090d71ea762367">FileHeader::describeISA</a>(<a class="code" href="_elf_binary_8cpp.html#adee8c7920607b19b82064b43a2075924">EHDR64_ENTRY</a>-&gt;e_machine);
<a name="l00494"></a>00494         }
<a name="l00495"></a>00495 
<a name="l00496"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a3907cf60c70f5abf4c5c9522c7f63a74">00496</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a3907cf60c70f5abf4c5c9522c7f63a74">ElfSymbol::ElfSymbol</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint64_t s, uint32_t i)
<a name="l00497"></a>00497             : <a class="code" href="class_e_p_a_x_1_1_symbol.html">Symbol</a>(b, o, s, i),
<a name="l00498"></a>00498               entry(<a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad060118c2df58d974a9f5526d820c184">INVALID_PTR</a>)
<a name="l00499"></a>00499         {
<a name="l00500"></a>00500         }
<a name="l00501"></a>00501 
<a name="l00502"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#af409dbd1b83de98f977c7d8eea73e66f">00502</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#af409dbd1b83de98f977c7d8eea73e66f">ElfSymbol::~ElfSymbol</a>(){
<a name="l00503"></a>00503             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a3c57705558738ca7aa9803260ff9da9e">entry</a>)){
<a name="l00504"></a>00504                 <span class="keyword">delete</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a3c57705558738ca7aa9803260ff9da9e">entry</a>;
<a name="l00505"></a>00505             }
<a name="l00506"></a>00506         }
<a name="l00507"></a>00507 
<a name="l00508"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html#a025f9dab1825e838634d998481bfa1cf">00508</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html#a025f9dab1825e838634d998481bfa1cf">ElfStringTable::print</a>(std::ostream&amp; stream){
<a name="l00509"></a>00509             stream &lt;&lt; <span class="stringliteral">&quot;ElfStringTable scn=&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(<a class="code" href="class_e_p_a_x_1_1_index_base.html#a6115276ca197b32637ed030b7afdc58e">getIndex</a>()) &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a90dc3f3ee970394e0080300526390a84">ENDL</a>;
<a name="l00510"></a>00510             uint32_t cur = 1;
<a name="l00511"></a>00511             <span class="keywordflow">while</span> (cur &lt; <a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>()){
<a name="l00512"></a>00512                 <span class="keywordtype">char</span>* t = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html#a5090981e577dceb27e8dd6c63f1992ba">getStringAt</a>(cur);
<a name="l00513"></a>00513                 stream &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(cur) &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; t &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a90dc3f3ee970394e0080300526390a84">ENDL</a>;
<a name="l00514"></a>00514                 cur += strlen(t) + 1;
<a name="l00515"></a>00515             }
<a name="l00516"></a>00516         }
<a name="l00517"></a>00517 
<a name="l00518"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol_table.html#af8c0bb17c3b8c38ee49142def9ee0ed0">00518</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol_table.html#af8c0bb17c3b8c38ee49142def9ee0ed0">ElfSymbolTable::print</a>(std::ostream&amp; stream){
<a name="l00519"></a>00519             stream &lt;&lt; <span class="stringliteral">&quot;ElfSymbolTable scn=&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(<a class="code" href="class_e_p_a_x_1_1_index_base.html#a6115276ca197b32637ed030b7afdc58e">getIndex</a>()) &lt;&lt; <span class="stringliteral">&quot; count=&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(<a class="code" href="class_e_p_a_x_1_1_symbol_table.html#a229729af626ddb0763a1bff287b68918">countSymbols</a>()) &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a90dc3f3ee970394e0080300526390a84">ENDL</a>;
<a name="l00520"></a>00520             <span class="keywordflow">for</span> (std::vector&lt;Symbol*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_symbol_table.html#ae9f0215b62e323d3edecd86fddae58c2">symbols</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_symbol_table.html#ae9f0215b62e323d3edecd86fddae58c2">symbols</a>-&gt;end(); it++){
<a name="l00521"></a>00521                 <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html">ElfSymbol</a>* sym = (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html">ElfSymbol</a>*)(*it);
<a name="l00522"></a>00522                 sym-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a19338c302c20a71a101be47205a44908">print</a>(stream);
<a name="l00523"></a>00523             }
<a name="l00524"></a>00524         }
<a name="l00525"></a>00525 
<a name="l00526"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a19338c302c20a71a101be47205a44908">00526</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a19338c302c20a71a101be47205a44908">ElfSymbol::print</a>(std::ostream&amp; stream){
<a name="l00527"></a>00527             stream &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(<a class="code" href="class_e_p_a_x_1_1_index_base.html#a6115276ca197b32637ed030b7afdc58e">getIndex</a>()) &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;
<a name="l00528"></a>00528 
<a name="l00529"></a>00529             <span class="keywordflow">if</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#ad6142f5f07372bffd2f0b9a482696821">isFunction</a>()){
<a name="l00530"></a>00530                 <span class="keywordflow">if</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a4f27b2be55f35a4c9a75b5e52bce6e23">isThumbFunction</a>()){
<a name="l00531"></a>00531                     stream &lt;&lt; <span class="stringliteral">&quot;*T&quot;</span>;
<a name="l00532"></a>00532                 } <span class="keywordflow">else</span> {
<a name="l00533"></a>00533                     stream &lt;&lt; <span class="stringliteral">&quot;*A&quot;</span>;
<a name="l00534"></a>00534                 }
<a name="l00535"></a>00535             }
<a name="l00536"></a>00536             stream &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> <span class="stringliteral">&quot;val=&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad3e71bdc71a21aa498036894462719e2">HEX</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a20b9df356b7d4ef1481dc8fdeaf4b2fc">getValue</a>())
<a name="l00537"></a>00537                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> <span class="stringliteral">&quot;size=&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a38fb6985ad991affbb10051eac2aa75e">getSize</a>())
<a name="l00538"></a>00538                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> <span class="stringliteral">&quot;name=&quot;</span> &lt;&lt; <a class="code" href="class_e_p_a_x_1_1_name_base.html#ac45bad0887b6a3283cc76047f91f7708">getName</a>()
<a name="l00539"></a>00539                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a90dc3f3ee970394e0080300526390a84">ENDL</a>;
<a name="l00540"></a>00540         }
<a name="l00541"></a>00541 
<a name="l00542"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a5abc8b081298263bef61b466cbfac2d1">00542</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a5abc8b081298263bef61b466cbfac2d1">ElfSymbol32::ElfSymbol32</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint32_t i)
<a name="l00543"></a>00543             : <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html">ElfSymbol</a>(b, o, sizeof(Elf32_Sym), i)
<a name="l00544"></a>00544         {
<a name="l00545"></a>00545             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a3c57705558738ca7aa9803260ff9da9e">entry</a> = (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#a17755bdd71c02e656c667b16de61dd7b">rawbyte_t</a>*)<span class="keyword">new</span> Elf32_Sym();
<a name="l00546"></a>00546             <a class="code" href="class_e_p_a_x_1_1_file_base.html#a996b93e64d317be72461c20089a1e91a">getInputFile</a>()-&gt;<a class="code" href="class_e_p_a_x_1_1_input_file.html#a4b7b6d515479e8d3006041a34f15b526">getBytes</a>(o, <a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>(), <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a3c57705558738ca7aa9803260ff9da9e">entry</a>);
<a name="l00547"></a>00547         }
<a name="l00548"></a>00548 
<a name="l00549"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a6a2d4c76afce4bb068cff341c55f88a3">00549</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a6a2d4c76afce4bb068cff341c55f88a3">ElfSymbol64::ElfSymbol64</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint32_t i)
<a name="l00550"></a>00550             : <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html">ElfSymbol</a>(b, o, sizeof(Elf64_Sym), i)
<a name="l00551"></a>00551         {
<a name="l00552"></a>00552             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a3c57705558738ca7aa9803260ff9da9e">entry</a> = (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#a17755bdd71c02e656c667b16de61dd7b">rawbyte_t</a>*)<span class="keyword">new</span> Elf64_Sym();
<a name="l00553"></a>00553             <a class="code" href="class_e_p_a_x_1_1_file_base.html#a996b93e64d317be72461c20089a1e91a">getInputFile</a>()-&gt;<a class="code" href="class_e_p_a_x_1_1_input_file.html#a4b7b6d515479e8d3006041a34f15b526">getBytes</a>(o, <a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>(), <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a3c57705558738ca7aa9803260ff9da9e">entry</a>);
<a name="l00554"></a>00554         }
<a name="l00555"></a>00555 
<a name="l00556"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a319c4e22fbb4b99667707a8b0d9412d1">00556</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a319c4e22fbb4b99667707a8b0d9412d1">ElfSymbol32::getNameIndex</a>(){
<a name="l00557"></a>00557             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#abd78d0bd3478762602df1232d10d1321">SYM32_ENTRY</a>-&gt;st_name;
<a name="l00558"></a>00558         }
<a name="l00559"></a>00559 
<a name="l00560"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a6e8651a83dfdd485e87e013b4a4790e2">00560</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a6e8651a83dfdd485e87e013b4a4790e2">ElfSymbol64::getNameIndex</a>(){
<a name="l00561"></a>00561             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a64f5c655a7547a00865a3102c75abbf1">SYM64_ENTRY</a>-&gt;st_name;
<a name="l00562"></a>00562         }
<a name="l00563"></a>00563 
<a name="l00564"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a2b4bb23d3d59280ccbbdf0b239bc4ce2">00564</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a2b4bb23d3d59280ccbbdf0b239bc4ce2">ElfSymbol32::getValue</a>(){
<a name="l00565"></a>00565             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#abd78d0bd3478762602df1232d10d1321">SYM32_ENTRY</a>-&gt;st_value;
<a name="l00566"></a>00566         }
<a name="l00567"></a>00567 
<a name="l00568"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a47e49dde9967bc7cf3f8caeb3b1880fd">00568</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a47e49dde9967bc7cf3f8caeb3b1880fd">ElfSymbol64::getValue</a>(){
<a name="l00569"></a>00569             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a64f5c655a7547a00865a3102c75abbf1">SYM64_ENTRY</a>-&gt;st_value;
<a name="l00570"></a>00570         }
<a name="l00571"></a>00571 
<a name="l00572"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#ae5ef1d81c0a3d126441e147104f8ea85">00572</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#ae5ef1d81c0a3d126441e147104f8ea85">ElfSymbol32::getSize</a>(){
<a name="l00573"></a>00573             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#abd78d0bd3478762602df1232d10d1321">SYM32_ENTRY</a>-&gt;st_size;
<a name="l00574"></a>00574         }
<a name="l00575"></a>00575 
<a name="l00576"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a26225a3989efc89a50fa934c53f47276">00576</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a26225a3989efc89a50fa934c53f47276">ElfSymbol64::getSize</a>(){
<a name="l00577"></a>00577             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a64f5c655a7547a00865a3102c75abbf1">SYM64_ENTRY</a>-&gt;st_size;
<a name="l00578"></a>00578         }
<a name="l00579"></a>00579 
<a name="l00580"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a5ae0934c001dc2a81dbd88fb1d0ad786">00580</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a5ae0934c001dc2a81dbd88fb1d0ad786">ElfSymbol32::getSection</a>(){
<a name="l00581"></a>00581             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#abd78d0bd3478762602df1232d10d1321">SYM32_ENTRY</a>-&gt;st_shndx;
<a name="l00582"></a>00582         }
<a name="l00583"></a>00583 
<a name="l00584"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#ad2acb7dbbf88685b5bfcfbed2ac1dba4">00584</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#ad2acb7dbbf88685b5bfcfbed2ac1dba4">ElfSymbol64::getSection</a>(){
<a name="l00585"></a>00585             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a64f5c655a7547a00865a3102c75abbf1">SYM64_ENTRY</a>-&gt;st_shndx;
<a name="l00586"></a>00586         }
<a name="l00587"></a>00587 
<a name="l00588"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a870365328bf8943618c3a3f907f26b24">00588</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a870365328bf8943618c3a3f907f26b24">ElfSymbol32::getType</a>(){
<a name="l00589"></a>00589             <span class="keywordflow">return</span> ELF32_ST_TYPE(<a class="code" href="_elf_binary_8cpp.html#abd78d0bd3478762602df1232d10d1321">SYM32_ENTRY</a>-&gt;st_info);
<a name="l00590"></a>00590         }
<a name="l00591"></a>00591 
<a name="l00592"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a397faa7562b27ba2d543328a69e17077">00592</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a397faa7562b27ba2d543328a69e17077">ElfSymbol64::getType</a>(){
<a name="l00593"></a>00593             <span class="keywordflow">return</span> ELF64_ST_TYPE(<a class="code" href="_elf_binary_8cpp.html#a64f5c655a7547a00865a3102c75abbf1">SYM64_ENTRY</a>-&gt;st_info);
<a name="l00594"></a>00594         }
<a name="l00595"></a>00595 
<a name="l00596"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a9361f33bf04cbfd6623392f1905aaef6">00596</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a9361f33bf04cbfd6623392f1905aaef6">ElfSymbol32::getBinding</a>(){
<a name="l00597"></a>00597             <span class="keywordflow">return</span> ELF32_ST_BIND(<a class="code" href="_elf_binary_8cpp.html#abd78d0bd3478762602df1232d10d1321">SYM32_ENTRY</a>-&gt;st_info);
<a name="l00598"></a>00598         }
<a name="l00599"></a>00599 
<a name="l00600"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a341e642319d9b9f70ee9dfebdcad4f5b">00600</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a341e642319d9b9f70ee9dfebdcad4f5b">ElfSymbol64::getBinding</a>(){
<a name="l00601"></a>00601             <span class="keywordflow">return</span> ELF64_ST_BIND(<a class="code" href="_elf_binary_8cpp.html#a64f5c655a7547a00865a3102c75abbf1">SYM64_ENTRY</a>-&gt;st_info);
<a name="l00602"></a>00602         }
<a name="l00603"></a>00603 
<a name="l00604"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a547bb437518ff680a5b35c36ebc5e39a">00604</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html#a547bb437518ff680a5b35c36ebc5e39a">ElfSymbol32::getVisibility</a>(){
<a name="l00605"></a>00605             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#abd78d0bd3478762602df1232d10d1321">SYM32_ENTRY</a>-&gt;st_other;
<a name="l00606"></a>00606         }
<a name="l00607"></a>00607 
<a name="l00608"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a0df4c678ba3e7c3e756c6a81152244fa">00608</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html#a0df4c678ba3e7c3e756c6a81152244fa">ElfSymbol64::getVisibility</a>(){
<a name="l00609"></a>00609             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a64f5c655a7547a00865a3102c75abbf1">SYM64_ENTRY</a>-&gt;st_other;
<a name="l00610"></a>00610         }
<a name="l00611"></a>00611 
<a name="l00612"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#ad6142f5f07372bffd2f0b9a482696821">00612</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#ad6142f5f07372bffd2f0b9a482696821">ElfSymbol::isFunction</a>(){
<a name="l00613"></a>00613             <span class="keywordflow">return</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a540aabaf19398d8512f7bdb9255fa9d6">getType</a>() == STT_FUNC);
<a name="l00614"></a>00614         }
<a name="l00615"></a>00615 
<a name="l00616"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a4f27b2be55f35a4c9a75b5e52bce6e23">00616</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a4f27b2be55f35a4c9a75b5e52bce6e23">ElfSymbol::isThumbFunction</a>(){
<a name="l00617"></a>00617             <span class="keywordflow">return</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#ad6142f5f07372bffd2f0b9a482696821">isFunction</a>() &amp;&amp; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad19561cc41062db213664fb462defc57">ADDRESS_IS_THUMB</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a20b9df356b7d4ef1481dc8fdeaf4b2fc">getValue</a>()));
<a name="l00618"></a>00618         }
<a name="l00619"></a>00619 
<a name="l00620"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a81a2839b65f94ce09a1f65a70bb268e1">00620</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a81a2839b65f94ce09a1f65a70bb268e1">ElfSymbol::getFunctionAddress</a>(){
<a name="l00621"></a>00621             <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a7b41ef1769db498d904361f6eb56a0eb">EPAXAssert</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#ad6142f5f07372bffd2f0b9a482696821">isFunction</a>(), <span class="stringliteral">&quot;This may only call this for function symbols&quot;</span>);
<a name="l00622"></a>00622             <span class="keywordflow">if</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a4f27b2be55f35a4c9a75b5e52bce6e23">isThumbFunction</a>()){
<a name="l00623"></a>00623                 <span class="keywordflow">return</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a20b9df356b7d4ef1481dc8fdeaf4b2fc">getValue</a>() - 1;
<a name="l00624"></a>00624             } <span class="keywordflow">else</span> {
<a name="l00625"></a>00625                 <span class="keywordflow">return</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a20b9df356b7d4ef1481dc8fdeaf4b2fc">getValue</a>();
<a name="l00626"></a>00626             }
<a name="l00627"></a>00627         }
<a name="l00628"></a>00628 
<a name="l00629"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html#a24ad50d1642c3c432e3623c0b633f59d">00629</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html#a24ad50d1642c3c432e3623c0b633f59d">ElfStringTable::ElfStringTable</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint64_t fs, uint64_t ma, uint64_t ms, uint32_t i, std::string n)
<a name="l00630"></a>00630             : <a class="code" href="class_e_p_a_x_1_1_string_table.html">StringTable</a>(b, o, fs, ma, ms, i, n),
<a name="l00631"></a>00631               entry(<a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad060118c2df58d974a9f5526d820c184">INVALID_PTR</a>)
<a name="l00632"></a>00632         {
<a name="l00633"></a>00633             entry = <span class="keyword">new</span> <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a17755bdd71c02e656c667b16de61dd7b">rawbyte_t</a>[<a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>()];
<a name="l00634"></a>00634             bzero(entry, <a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>());
<a name="l00635"></a>00635             <a class="code" href="class_e_p_a_x_1_1_file_base.html#a996b93e64d317be72461c20089a1e91a">getInputFile</a>()-&gt;<a class="code" href="class_e_p_a_x_1_1_input_file.html#a4b7b6d515479e8d3006041a34f15b526">getBytes</a>(<a class="code" href="class_e_p_a_x_1_1_file_base.html#a779f2254eef1279f52f372e18bfb75f7">getFileOffset</a>(), <a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>(), entry);
<a name="l00636"></a>00636         }
<a name="l00637"></a>00637 
<a name="l00638"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html#a7eb7c7cf0000dbc952084bf544cef094">00638</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html#a7eb7c7cf0000dbc952084bf544cef094">ElfStringTable::~ElfStringTable</a>(){
<a name="l00639"></a>00639             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(entry)){
<a name="l00640"></a>00640                 <span class="keyword">delete</span>[] entry;
<a name="l00641"></a>00641             }
<a name="l00642"></a>00642         }
<a name="l00643"></a>00643 
<a name="l00644"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html#a5090981e577dceb27e8dd6c63f1992ba">00644</a>         <span class="keywordtype">char</span>* <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html#a5090981e577dceb27e8dd6c63f1992ba">ElfStringTable::getStringAt</a>(uint32_t i){
<a name="l00645"></a>00645             <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a7b41ef1769db498d904361f6eb56a0eb">EPAXAssert</a>(i &lt; <a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>(), <span class="stringliteral">&quot;StringTable index (&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(i) &lt;&lt; <span class="stringliteral">&quot;) out of bounds (&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(<a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>()) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);
<a name="l00646"></a>00646             <span class="keywordflow">return</span> (<span class="keywordtype">char</span>*)&amp;(entry[i]);
<a name="l00647"></a>00647         }
<a name="l00648"></a>00648 
<a name="l00649"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol_table.html#a33103257dce585b4f3ace8cad4bb0d8d">00649</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol_table.html#a33103257dce585b4f3ace8cad4bb0d8d">ElfSymbolTable::ElfSymbolTable</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint64_t fs, uint64_t ma, uint64_t ms, uint32_t i, std::string n, <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html">ElfStringTable</a>* st)
<a name="l00650"></a>00650             : <a class="code" href="class_e_p_a_x_1_1_symbol_table.html">SymbolTable</a>(b, o, fs, ma, ms, i, n),
<a name="l00651"></a>00651               stringtab(NULL)
<a name="l00652"></a>00652         {
<a name="l00653"></a>00653             stringtab = st;
<a name="l00654"></a>00654             <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a7b41ef1769db498d904361f6eb56a0eb">EPAXAssert</a>(<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(stringtab), <span class="stringliteral">&quot;A symbol table in ELF requires a valid string table&quot;</span>);
<a name="l00655"></a>00655 
<a name="l00656"></a>00656             uint32_t tablesize = 0;
<a name="l00657"></a>00657             <a class="code" href="class_e_p_a_x_1_1_symbol_table.html#ae9f0215b62e323d3edecd86fddae58c2">symbols</a> = <span class="keyword">new</span> std::vector&lt;Symbol*&gt;();
<a name="l00658"></a>00658 
<a name="l00659"></a>00659             uint32_t cur = 0;
<a name="l00660"></a>00660             <span class="keywordflow">while</span> (tablesize &lt; <a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>()){
<a name="l00661"></a>00661                 <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html">ElfSymbol</a>* e;
<a name="l00662"></a>00662                 <span class="keywordflow">if</span> (<a class="code" href="class_e_p_a_x_1_1_file_base.html#ab5c2b2dfb21a45a07121d3c0f7942e8b">is32Bit</a>()){
<a name="l00663"></a>00663                     e = <span class="keyword">new</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol32.html">ElfSymbol32</a>(<a class="code" href="class_e_p_a_x_1_1_file_base.html#a2b31d9b96a82c8702aa2e20017039fd4">getBinary</a>(), <a class="code" href="class_e_p_a_x_1_1_file_base.html#a779f2254eef1279f52f372e18bfb75f7">getFileOffset</a>() + tablesize, cur);
<a name="l00664"></a>00664                 } <span class="keywordflow">else</span> {
<a name="l00665"></a>00665                     e = <span class="keyword">new</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol64.html">ElfSymbol64</a>(<a class="code" href="class_e_p_a_x_1_1_file_base.html#a2b31d9b96a82c8702aa2e20017039fd4">getBinary</a>(), <a class="code" href="class_e_p_a_x_1_1_file_base.html#a779f2254eef1279f52f372e18bfb75f7">getFileOffset</a>() + tablesize, cur);
<a name="l00666"></a>00666                 }
<a name="l00667"></a>00667                 tablesize += e-&gt;<a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>();
<a name="l00668"></a>00668                 e-&gt;<a class="code" href="class_e_p_a_x_1_1_name_base.html#a0249989dc06f3563cdee08435856d15d">setName</a>(st-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_string_table.html#a5090981e577dceb27e8dd6c63f1992ba">getStringAt</a>(e-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_symbol.html#a84ccb1d566bee093da094e2c4b617ba7">getNameIndex</a>()));
<a name="l00669"></a>00669 
<a name="l00670"></a>00670                 <a class="code" href="class_e_p_a_x_1_1_symbol_table.html#ae9f0215b62e323d3edecd86fddae58c2">symbols</a>-&gt;push_back(e);
<a name="l00671"></a>00671                 cur++;
<a name="l00672"></a>00672             }
<a name="l00673"></a>00673 
<a name="l00674"></a>00674             <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a7b41ef1769db498d904361f6eb56a0eb">EPAXAssert</a>(tablesize == <a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>(), <span class="stringliteral">&quot;Symbol table size (&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(tablesize) &lt;&lt; <span class="stringliteral">&quot;) does not match expected size (&quot;</span> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(<a class="code" href="class_e_p_a_x_1_1_file_base.html#a41637ea5355a70fee2467f279964e064">getFileSize</a>()) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);
<a name="l00675"></a>00675         }
<a name="l00676"></a>00676 
<a name="l00677"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a54cc02de71e0399deb189afa5261f69a">00677</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a54cc02de71e0399deb189afa5261f69a">SectionHeader::SectionHeader</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint64_t s, uint32_t i)
<a name="l00678"></a>00678             : <a class="code" href="class_e_p_a_x_1_1_file_base.html">FileBase</a>(b, o, s),
<a name="l00679"></a>00679               <a class="code" href="class_e_p_a_x_1_1_name_base.html">NameBase</a>(),
<a name="l00680"></a>00680               <a class="code" href="class_e_p_a_x_1_1_index_base.html">IndexBase</a>(i),
<a name="l00681"></a>00681               entry(<a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad060118c2df58d974a9f5526d820c184">INVALID_PTR</a>)
<a name="l00682"></a>00682         {
<a name="l00683"></a>00683         }
<a name="l00684"></a>00684 
<a name="l00685"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a6e422772b689a748bd07d9e432419b72">00685</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a6e422772b689a748bd07d9e432419b72">SectionHeader::~SectionHeader</a>(){
<a name="l00686"></a>00686             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a84d8a573ab3f70298e15d46e83197260">entry</a>)){
<a name="l00687"></a>00687                 <span class="keyword">delete</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a84d8a573ab3f70298e15d46e83197260">entry</a>;
<a name="l00688"></a>00688             }
<a name="l00689"></a>00689         }
<a name="l00690"></a>00690 
<a name="l00691"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a3696fa6a32c99da64d87a686a881fe9a">00691</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a3696fa6a32c99da64d87a686a881fe9a">ProgramHeader::ProgramHeader</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint64_t s, uint32_t i)
<a name="l00692"></a>00692             : <a class="code" href="class_e_p_a_x_1_1_file_base.html">FileBase</a>(b, o, s),
<a name="l00693"></a>00693               <a class="code" href="class_e_p_a_x_1_1_index_base.html">IndexBase</a>(i),
<a name="l00694"></a>00694               entry(<a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad060118c2df58d974a9f5526d820c184">INVALID_PTR</a>)
<a name="l00695"></a>00695         {
<a name="l00696"></a>00696         }
<a name="l00697"></a>00697 
<a name="l00698"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a9da71f94c2c142aafde175151d48937f">00698</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a9da71f94c2c142aafde175151d48937f">ProgramHeader::~ProgramHeader</a>(){
<a name="l00699"></a>00699             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a25865997e5c358b60ff630a68494c89c">entry</a>)){
<a name="l00700"></a>00700                 <span class="keyword">delete</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a25865997e5c358b60ff630a68494c89c">entry</a>;
<a name="l00701"></a>00701             }
<a name="l00702"></a>00702         }
<a name="l00703"></a>00703 
<a name="l00704"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae200e871cf5c040ed1d8ed074eb1e5c2">00704</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#ae200e871cf5c040ed1d8ed074eb1e5c2">ElfBinary::printSections</a>(std::ostream&amp; stream){
<a name="l00705"></a>00705             stream &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a90dc3f3ee970394e0080300526390a84">ENDL</a>;
<a name="l00706"></a>00706             stream &lt;&lt; <span class="stringliteral">&quot;Printing all Section Headers in &quot;</span> &lt;&lt; <a class="code" href="class_e_p_a_x_1_1_name_base.html#ac45bad0887b6a3283cc76047f91f7708">getName</a>() &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a90dc3f3ee970394e0080300526390a84">ENDL</a>;
<a name="l00707"></a>00707             stream &lt;&lt; <span class="stringliteral">&quot;ELF_SHDR [&quot;</span> &lt;&lt; std::setw(2) &lt;&lt; <span class="stringliteral">&quot;ID&quot;</span> &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>
<a name="l00708"></a>00708                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; std::setw(18) &lt;&lt; <span class="stringliteral">&quot;NAME&quot;</span>
<a name="l00709"></a>00709                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; <span class="stringliteral">&quot;VIRTADDR&quot;</span>
<a name="l00710"></a>00710                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; <span class="stringliteral">&quot;MEM_SIZE&quot;</span>
<a name="l00711"></a>00711                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; <span class="stringliteral">&quot;FLOFFSET&quot;</span>
<a name="l00712"></a>00712                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; <span class="stringliteral">&quot;ALGN&quot;</span>
<a name="l00713"></a>00713                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; <span class="stringliteral">&quot;FLAGS&quot;</span>
<a name="l00714"></a>00714                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; <span class="stringliteral">&quot;SECTYP&quot;</span>
<a name="l00715"></a>00715                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a90dc3f3ee970394e0080300526390a84">ENDL</a>;
<a name="l00716"></a>00716             <span class="keywordflow">if</span> (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#acb70e5a725963e9f75d6550f12d86081">IS_VALID_PTR</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>)){
<a name="l00717"></a>00717                 <span class="keywordflow">for</span> (std::vector&lt;SectionHeader*&gt;::const_iterator it = <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;begin(); it != <a class="code" href="class_e_p_a_x_1_1_elf_1_1_elf_binary.html#afbb96059b56ec958d3901a1562343224">sections</a>-&gt;end(); it++){
<a name="l00718"></a>00718                     <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html">SectionHeader</a>* shdr = (*it);
<a name="l00719"></a>00719                     shdr-&gt;<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a52fc6666a33be6852fbcc6894cc3d655">print</a>(stream);
<a name="l00720"></a>00720                 }
<a name="l00721"></a>00721             }
<a name="l00722"></a>00722         }
<a name="l00723"></a>00723 
<a name="l00724"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a52fc6666a33be6852fbcc6894cc3d655">00724</a>         <span class="keywordtype">void</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a52fc6666a33be6852fbcc6894cc3d655">SectionHeader::print</a>(std::ostream&amp; stream){
<a name="l00725"></a>00725             stream &lt;&lt; <span class="stringliteral">&quot;ELF_SHDR [&quot;</span> &lt;&lt; std::setw(2) &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(<a class="code" href="class_e_p_a_x_1_1_index_base.html#a6115276ca197b32637ed030b7afdc58e">getIndex</a>()) &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>
<a name="l00726"></a>00726                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; std::setw(18) &lt;&lt; <a class="code" href="class_e_p_a_x_1_1_name_base.html#ac45bad0887b6a3283cc76047f91f7708">getName</a>() 
<a name="l00727"></a>00727                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad3e71bdc71a21aa498036894462719e2">HEX</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a34bc5ee9fc05b1780e8cca68828bfc23">getVirtAddr</a>())
<a name="l00728"></a>00728                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad3e71bdc71a21aa498036894462719e2">HEX</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a2d9cd842c34c4075260116f0ab373fa2">getSize</a>())
<a name="l00729"></a>00729                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad3e71bdc71a21aa498036894462719e2">HEX</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a1beecb645d931ff31696e9994f1f0e06">getFileOffset</a>())
<a name="l00730"></a>00730                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; std::setw(4) &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#af6f4c2c170f7cbe89cdec2d3c2d7cfce">DEC</a>(<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a65a863f2eb15aa211d772fc1b3013d64">getAlignment</a>())
<a name="l00731"></a>00731                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ae6a3998c6af4e70913fa7bb1dd17642d">isRead</a>()? <span class="stringliteral">&quot;R&quot;</span>:<span class="stringliteral">&quot; &quot;</span>) &lt;&lt; (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a5e33ad1689cd25b074f81397148bfd96">isWrite</a>()? <span class="stringliteral">&quot;W&quot;</span>:<span class="stringliteral">&quot; &quot;</span>) &lt;&lt; (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af6c441b3851a2311ad73a4ca3a550f33">isExec</a>()? <span class="stringliteral">&quot;X&quot;</span>:<span class="stringliteral">&quot; &quot;</span>) &lt;&lt; (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a31d2e329b17565b128798f80ed0779e1">isAlloc</a>()? <span class="stringliteral">&quot;A&quot;</span>:<span class="stringliteral">&quot; &quot;</span>) &lt;&lt; (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#aac6b62764b01dceae67f5fff1c966a70">isMerge</a>()? <span class="stringliteral">&quot;M&quot;</span>:<span class="stringliteral">&quot; &quot;</span>)
<a name="l00732"></a>00732                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#ad58a1fbfc85c7e4790fc55e654f50221">TAB</a> &lt;&lt; (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#adf62f9619c5cdbe66524f864db451e26">isText</a>()? <span class="stringliteral">&quot;T&quot;</span>:<span class="stringliteral">&quot; &quot;</span>) &lt;&lt; (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ad554ff1dd465817c89bc817ac4e5d307">isData</a>()? <span class="stringliteral">&quot;D&quot;</span>:<span class="stringliteral">&quot; &quot;</span>) &lt;&lt; (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#aeb485b30076f37e8ebc7c46e14c239f9">isBSS</a>()? <span class="stringliteral">&quot;B&quot;</span>:<span class="stringliteral">&quot; &quot;</span>) &lt;&lt; (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ab1e8c09b12f6e5caef352d2eb32b7b7d">isDebug</a>()? <span class="stringliteral">&quot;D&quot;</span>:<span class="stringliteral">&quot; &quot;</span>) &lt;&lt; (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a6d66cd345b7cb520d758ae04c50164e1">isString</a>()? <span class="stringliteral">&quot;R&quot;</span>:<span class="stringliteral">&quot; &quot;</span>) &lt;&lt; (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a9320f92c5158659c148ee6f197b0cd70">isSymbol</a>()? <span class="stringliteral">&quot;Y&quot;</span>:<span class="stringliteral">&quot; &quot;</span>)
<a name="l00733"></a>00733                       &lt;&lt; <a class="code" href="_e_p_a_x_common_internal_8hpp.html#a90dc3f3ee970394e0080300526390a84">ENDL</a>;
<a name="l00734"></a>00734         }
<a name="l00735"></a>00735 
<a name="l00736"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#aaeba234d199df23d8be4ab874e6a8bac">00736</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#aaeba234d199df23d8be4ab874e6a8bac">SectionHeader::inRange</a>(uint64_t a){
<a name="l00737"></a>00737             <span class="keywordflow">if</span> (a &gt;= <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a34bc5ee9fc05b1780e8cca68828bfc23">getVirtAddr</a>() &amp;&amp; a &lt; <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a34bc5ee9fc05b1780e8cca68828bfc23">getVirtAddr</a>() + <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a2d9cd842c34c4075260116f0ab373fa2">getSize</a>()){
<a name="l00738"></a>00738                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00739"></a>00739             }
<a name="l00740"></a>00740             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00741"></a>00741         }
<a name="l00742"></a>00742 
<a name="l00743"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#adf62f9619c5cdbe66524f864db451e26">00743</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#adf62f9619c5cdbe66524f864db451e26">SectionHeader::isText</a>(){
<a name="l00744"></a>00744             <span class="keywordflow">return</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af7e6230e8d4b68886ef8dcda238f1072">getType</a>() == SHT_PROGBITS &amp;&amp; <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af6c441b3851a2311ad73a4ca3a550f33">isExec</a>());
<a name="l00745"></a>00745         }
<a name="l00746"></a>00746 
<a name="l00747"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ad554ff1dd465817c89bc817ac4e5d307">00747</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ad554ff1dd465817c89bc817ac4e5d307">SectionHeader::isData</a>(){
<a name="l00748"></a>00748             <span class="keywordflow">return</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af7e6230e8d4b68886ef8dcda238f1072">getType</a>() == SHT_PROGBITS &amp;&amp; <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a5e33ad1689cd25b074f81397148bfd96">isWrite</a>());
<a name="l00749"></a>00749         }
<a name="l00750"></a>00750 
<a name="l00751"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#aeb485b30076f37e8ebc7c46e14c239f9">00751</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#aeb485b30076f37e8ebc7c46e14c239f9">SectionHeader::isBSS</a>(){
<a name="l00752"></a>00752             <span class="keywordflow">return</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af7e6230e8d4b68886ef8dcda238f1072">getType</a>() == SHT_NOBITS &amp;&amp; <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a5e33ad1689cd25b074f81397148bfd96">isWrite</a>());
<a name="l00753"></a>00753         }
<a name="l00754"></a>00754 
<a name="l00755"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ab1e8c09b12f6e5caef352d2eb32b7b7d">00755</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ab1e8c09b12f6e5caef352d2eb32b7b7d">SectionHeader::isDebug</a>(){
<a name="l00756"></a>00756             <span class="keywordflow">return</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af7e6230e8d4b68886ef8dcda238f1072">getType</a>() == SHT_PROGBITS &amp;&amp; !<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a31d2e329b17565b128798f80ed0779e1">isAlloc</a>() &amp;&amp; !<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a5e33ad1689cd25b074f81397148bfd96">isWrite</a>() &amp;&amp; !<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af6c441b3851a2311ad73a4ca3a550f33">isExec</a>());
<a name="l00757"></a>00757         }
<a name="l00758"></a>00758 
<a name="l00759"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a6d66cd345b7cb520d758ae04c50164e1">00759</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a6d66cd345b7cb520d758ae04c50164e1">SectionHeader::isString</a>(){
<a name="l00760"></a>00760             <span class="keywordflow">return</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af7e6230e8d4b68886ef8dcda238f1072">getType</a>() == SHT_STRTAB);
<a name="l00761"></a>00761         }
<a name="l00762"></a>00762 
<a name="l00763"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a9320f92c5158659c148ee6f197b0cd70">00763</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a9320f92c5158659c148ee6f197b0cd70">SectionHeader::isSymbol</a>(){
<a name="l00764"></a>00764             <span class="keywordflow">return</span> (<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af7e6230e8d4b68886ef8dcda238f1072">getType</a>() == SHT_SYMTAB || <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af7e6230e8d4b68886ef8dcda238f1072">getType</a>() == SHT_DYNSYM);
<a name="l00765"></a>00765         }
<a name="l00766"></a>00766 
<a name="l00767"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ae6a3998c6af4e70913fa7bb1dd17642d">00767</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ae6a3998c6af4e70913fa7bb1dd17642d">SectionHeader::isRead</a>(){
<a name="l00768"></a>00768             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00769"></a>00769         }
<a name="l00770"></a>00770 
<a name="l00771"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a5e33ad1689cd25b074f81397148bfd96">00771</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a5e33ad1689cd25b074f81397148bfd96">SectionHeader::isWrite</a>(){
<a name="l00772"></a>00772             <span class="keywordflow">return</span> ((<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ab573a5f4b64afd5dc7f5b835c5b1becf">getFlags</a>() &amp; SHF_WRITE) != 0);
<a name="l00773"></a>00773         }
<a name="l00774"></a>00774 
<a name="l00775"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af6c441b3851a2311ad73a4ca3a550f33">00775</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#af6c441b3851a2311ad73a4ca3a550f33">SectionHeader::isExec</a>(){
<a name="l00776"></a>00776             <span class="keywordflow">return</span> ((<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ab573a5f4b64afd5dc7f5b835c5b1becf">getFlags</a>() &amp; SHF_EXECINSTR) != 0);
<a name="l00777"></a>00777         }
<a name="l00778"></a>00778 
<a name="l00779"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a31d2e329b17565b128798f80ed0779e1">00779</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a31d2e329b17565b128798f80ed0779e1">SectionHeader::isAlloc</a>(){
<a name="l00780"></a>00780             <span class="keywordflow">return</span> ((<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ab573a5f4b64afd5dc7f5b835c5b1becf">getFlags</a>() &amp; SHF_ALLOC) != 0);
<a name="l00781"></a>00781         }
<a name="l00782"></a>00782 
<a name="l00783"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#aac6b62764b01dceae67f5fff1c966a70">00783</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#aac6b62764b01dceae67f5fff1c966a70">SectionHeader::isMerge</a>(){
<a name="l00784"></a>00784             <span class="keywordflow">return</span> ((<a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#ab573a5f4b64afd5dc7f5b835c5b1becf">getFlags</a>() &amp; SHF_MERGE) != 0);
<a name="l00785"></a>00785         }
<a name="l00786"></a>00786 
<a name="l00787"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a03a69e255bde29bc1c035fd8a3800e0d">00787</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a03a69e255bde29bc1c035fd8a3800e0d">SectionHeader32::SectionHeader32</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint64_t s, uint32_t i)
<a name="l00788"></a>00788             : <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html">SectionHeader</a>(b, o, s, i)
<a name="l00789"></a>00789         {
<a name="l00790"></a>00790             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a84d8a573ab3f70298e15d46e83197260">entry</a> = (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#a17755bdd71c02e656c667b16de61dd7b">rawbyte_t</a>*)<span class="keyword">new</span> Elf32_Shdr();
<a name="l00791"></a>00791             <a class="code" href="class_e_p_a_x_1_1_file_base.html#a996b93e64d317be72461c20089a1e91a">getInputFile</a>()-&gt;<a class="code" href="class_e_p_a_x_1_1_input_file.html#a4b7b6d515479e8d3006041a34f15b526">getBytes</a>(o, <span class="keyword">sizeof</span>(Elf32_Shdr), <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a84d8a573ab3f70298e15d46e83197260">entry</a>);
<a name="l00792"></a>00792         }
<a name="l00793"></a>00793 
<a name="l00794"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a093e7ab0649ce9c396705d832b593018">00794</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a093e7ab0649ce9c396705d832b593018">SectionHeader64::SectionHeader64</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint64_t s, uint32_t i)
<a name="l00795"></a>00795             : <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html">SectionHeader</a>(b, o, s, i)
<a name="l00796"></a>00796         {
<a name="l00797"></a>00797             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a84d8a573ab3f70298e15d46e83197260">entry</a> = (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#a17755bdd71c02e656c667b16de61dd7b">rawbyte_t</a>*)<span class="keyword">new</span> Elf64_Shdr();
<a name="l00798"></a>00798             <a class="code" href="class_e_p_a_x_1_1_file_base.html#a996b93e64d317be72461c20089a1e91a">getInputFile</a>()-&gt;<a class="code" href="class_e_p_a_x_1_1_input_file.html#a4b7b6d515479e8d3006041a34f15b526">getBytes</a>(o, <span class="keyword">sizeof</span>(Elf64_Shdr), <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header.html#a84d8a573ab3f70298e15d46e83197260">entry</a>);
<a name="l00799"></a>00799         }
<a name="l00800"></a>00800 
<a name="l00801"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a03ea8c9bb8bb24b88f75158085ef557e">00801</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a03ea8c9bb8bb24b88f75158085ef557e">SectionHeader32::getNameIndex</a>(){
<a name="l00802"></a>00802             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a824b027d2116797a3dfd9cde0ff56987">SHDR32_ENTRY</a>-&gt;sh_name;
<a name="l00803"></a>00803         }
<a name="l00804"></a>00804 
<a name="l00805"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a4c83a831f07f96738a32fefd2f55b669">00805</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a4c83a831f07f96738a32fefd2f55b669">SectionHeader64::getNameIndex</a>(){
<a name="l00806"></a>00806             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a69a1f1681babbf982bec2f34e81495bf">SHDR64_ENTRY</a>-&gt;sh_name;
<a name="l00807"></a>00807         }
<a name="l00808"></a>00808 
<a name="l00809"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a84ed73ec4cb58e9919222a884dbe0cd3">00809</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a84ed73ec4cb58e9919222a884dbe0cd3">SectionHeader32::getType</a>(){
<a name="l00810"></a>00810             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a824b027d2116797a3dfd9cde0ff56987">SHDR32_ENTRY</a>-&gt;sh_type;
<a name="l00811"></a>00811         }
<a name="l00812"></a>00812 
<a name="l00813"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a8556b692a71aba5e1048a7152cb1d837">00813</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a8556b692a71aba5e1048a7152cb1d837">SectionHeader64::getType</a>(){
<a name="l00814"></a>00814             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a69a1f1681babbf982bec2f34e81495bf">SHDR64_ENTRY</a>-&gt;sh_type;
<a name="l00815"></a>00815         }
<a name="l00816"></a>00816 
<a name="l00817"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a04f7dbe427fb6c19261b5de7cbacfd05">00817</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a04f7dbe427fb6c19261b5de7cbacfd05">SectionHeader32::getSize</a>(){
<a name="l00818"></a>00818             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a824b027d2116797a3dfd9cde0ff56987">SHDR32_ENTRY</a>-&gt;sh_size;
<a name="l00819"></a>00819         }
<a name="l00820"></a>00820 
<a name="l00821"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a0b4f7cd68d065481a6953240f55f8073">00821</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a0b4f7cd68d065481a6953240f55f8073">SectionHeader64::getSize</a>(){
<a name="l00822"></a>00822             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a69a1f1681babbf982bec2f34e81495bf">SHDR64_ENTRY</a>-&gt;sh_size;
<a name="l00823"></a>00823         }
<a name="l00824"></a>00824 
<a name="l00825"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a0d804e41f351baa2a0165e705e84ce86">00825</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a0d804e41f351baa2a0165e705e84ce86">SectionHeader32::getVirtAddr</a>(){
<a name="l00826"></a>00826             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a824b027d2116797a3dfd9cde0ff56987">SHDR32_ENTRY</a>-&gt;sh_addr;
<a name="l00827"></a>00827         }
<a name="l00828"></a>00828 
<a name="l00829"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a5d82c8c6748a80bb0d53b8d6a6a9c3fb">00829</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a5d82c8c6748a80bb0d53b8d6a6a9c3fb">SectionHeader64::getVirtAddr</a>(){
<a name="l00830"></a>00830             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a69a1f1681babbf982bec2f34e81495bf">SHDR64_ENTRY</a>-&gt;sh_addr;
<a name="l00831"></a>00831         }
<a name="l00832"></a>00832 
<a name="l00833"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a10cf04485e82a2f38b852732345dcd29">00833</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a10cf04485e82a2f38b852732345dcd29">SectionHeader32::getFileOffset</a>(){
<a name="l00834"></a>00834             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a824b027d2116797a3dfd9cde0ff56987">SHDR32_ENTRY</a>-&gt;sh_offset;
<a name="l00835"></a>00835         }
<a name="l00836"></a>00836 
<a name="l00837"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#acd9363817d1fbab5194a3da55e8a7240">00837</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#acd9363817d1fbab5194a3da55e8a7240">SectionHeader64::getFileOffset</a>(){
<a name="l00838"></a>00838             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a69a1f1681babbf982bec2f34e81495bf">SHDR64_ENTRY</a>-&gt;sh_offset;
<a name="l00839"></a>00839         }
<a name="l00840"></a>00840 
<a name="l00841"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#ad60ce4da7aa979dcf82115920f3b3664">00841</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#ad60ce4da7aa979dcf82115920f3b3664">SectionHeader32::getSectionLink</a>(){
<a name="l00842"></a>00842             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a824b027d2116797a3dfd9cde0ff56987">SHDR32_ENTRY</a>-&gt;sh_link;
<a name="l00843"></a>00843         }
<a name="l00844"></a>00844 
<a name="l00845"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#aed1f49f68dc2b948fb8c5fe7d6df6ec5">00845</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#aed1f49f68dc2b948fb8c5fe7d6df6ec5">SectionHeader64::getSectionLink</a>(){
<a name="l00846"></a>00846             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a69a1f1681babbf982bec2f34e81495bf">SHDR64_ENTRY</a>-&gt;sh_link;
<a name="l00847"></a>00847         }
<a name="l00848"></a>00848 
<a name="l00849"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a36d45234fbdfd27ac89e449f0084e985">00849</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a36d45234fbdfd27ac89e449f0084e985">SectionHeader32::getAlignment</a>(){
<a name="l00850"></a>00850             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a824b027d2116797a3dfd9cde0ff56987">SHDR32_ENTRY</a>-&gt;sh_addralign;
<a name="l00851"></a>00851         }
<a name="l00852"></a>00852 
<a name="l00853"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a8efa6c61a662689bd23732884b4a9aa5">00853</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a8efa6c61a662689bd23732884b4a9aa5">SectionHeader64::getAlignment</a>(){
<a name="l00854"></a>00854             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a69a1f1681babbf982bec2f34e81495bf">SHDR64_ENTRY</a>-&gt;sh_addralign;
<a name="l00855"></a>00855         }
<a name="l00856"></a>00856 
<a name="l00857"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#adbddf01ab8a4115d7c07dfe92e2160c6">00857</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#adbddf01ab8a4115d7c07dfe92e2160c6">SectionHeader32::getEntrySize</a>(){
<a name="l00858"></a>00858             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a824b027d2116797a3dfd9cde0ff56987">SHDR32_ENTRY</a>-&gt;sh_entsize;
<a name="l00859"></a>00859         }
<a name="l00860"></a>00860 
<a name="l00861"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a3b16015c2864179254466fa389a5b90e">00861</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a3b16015c2864179254466fa389a5b90e">SectionHeader64::getEntrySize</a>(){
<a name="l00862"></a>00862             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a69a1f1681babbf982bec2f34e81495bf">SHDR64_ENTRY</a>-&gt;sh_entsize;
<a name="l00863"></a>00863         }
<a name="l00864"></a>00864 
<a name="l00865"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a6235f57290293d0836cee2adadf7c924">00865</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header32.html#a6235f57290293d0836cee2adadf7c924">SectionHeader32::getFlags</a>(){
<a name="l00866"></a>00866             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a824b027d2116797a3dfd9cde0ff56987">SHDR32_ENTRY</a>-&gt;sh_flags;
<a name="l00867"></a>00867         }
<a name="l00868"></a>00868 
<a name="l00869"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a4ca003bc2633ba8e16824a0d6f9f5dd1">00869</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_section_header64.html#a4ca003bc2633ba8e16824a0d6f9f5dd1">SectionHeader64::getFlags</a>(){
<a name="l00870"></a>00870             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a69a1f1681babbf982bec2f34e81495bf">SHDR64_ENTRY</a>-&gt;sh_flags;
<a name="l00871"></a>00871         }        
<a name="l00872"></a>00872 
<a name="l00873"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#ae31e5d8dba8226b42315bcfa28b5d596">00873</a>         <span class="keywordtype">bool</span> <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#ae31e5d8dba8226b42315bcfa28b5d596">ProgramHeader::isValidVaddr</a>(uint64_t v){
<a name="l00874"></a>00874             <span class="keywordflow">return</span> (v &gt;= <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#aa8a7d552ece248bccfda3d320fe2d2ab">getVaddr</a>() &amp;&amp; v &lt; <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#aa8a7d552ece248bccfda3d320fe2d2ab">getVaddr</a>() + <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#ab624186a1963231b21722025d9f87a32">getMSize</a>());
<a name="l00875"></a>00875         }
<a name="l00876"></a>00876 
<a name="l00877"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a42aab9c522155567f18175b1f09d4d3c">00877</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a42aab9c522155567f18175b1f09d4d3c">ProgramHeader::vaddrToFileaddr</a>(uint64_t v){
<a name="l00878"></a>00878             <span class="keywordflow">if</span> (!<a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#ae31e5d8dba8226b42315bcfa28b5d596">isValidVaddr</a>(v)){
<a name="l00879"></a>00879                 <span class="keywordflow">return</span> 0;
<a name="l00880"></a>00880             }
<a name="l00881"></a>00881             <span class="keywordflow">return</span> v - <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#aa8a7d552ece248bccfda3d320fe2d2ab">getVaddr</a>() + <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a328166b748f2717c9da393210f7aa9cc">getFOffset</a>();
<a name="l00882"></a>00882         }
<a name="l00883"></a>00883 
<a name="l00884"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a989edb2ff17c082517e51416331c1904">00884</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a989edb2ff17c082517e51416331c1904">ProgramHeader32::ProgramHeader32</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint64_t s, uint32_t i)
<a name="l00885"></a>00885             : <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html">ProgramHeader</a>(b, o, s, i)
<a name="l00886"></a>00886         {
<a name="l00887"></a>00887             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a25865997e5c358b60ff630a68494c89c">entry</a> = (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#a17755bdd71c02e656c667b16de61dd7b">rawbyte_t</a>*)<span class="keyword">new</span> Elf32_Phdr();
<a name="l00888"></a>00888             <a class="code" href="class_e_p_a_x_1_1_file_base.html#a996b93e64d317be72461c20089a1e91a">getInputFile</a>()-&gt;<a class="code" href="class_e_p_a_x_1_1_input_file.html#a4b7b6d515479e8d3006041a34f15b526">getBytes</a>(o, <span class="keyword">sizeof</span>(Elf32_Phdr), <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a25865997e5c358b60ff630a68494c89c">entry</a>);
<a name="l00889"></a>00889         }
<a name="l00890"></a>00890 
<a name="l00891"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#aa65ae437cdc94378ed92b3a843325d3e">00891</a>         <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#aa65ae437cdc94378ed92b3a843325d3e">ProgramHeader64::ProgramHeader64</a>(<a class="code" href="class_e_p_a_x_1_1_base_binary.html">BaseBinary</a>* b, uint64_t o, uint64_t s, uint32_t i)
<a name="l00892"></a>00892             : <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html">ProgramHeader</a>(b, o, s, i)
<a name="l00893"></a>00893         {
<a name="l00894"></a>00894             <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a25865997e5c358b60ff630a68494c89c">entry</a> = (<a class="code" href="_e_p_a_x_common_internal_8hpp.html#a17755bdd71c02e656c667b16de61dd7b">rawbyte_t</a>*)<span class="keyword">new</span> Elf64_Phdr();
<a name="l00895"></a>00895             <a class="code" href="class_e_p_a_x_1_1_file_base.html#a996b93e64d317be72461c20089a1e91a">getInputFile</a>()-&gt;<a class="code" href="class_e_p_a_x_1_1_input_file.html#a4b7b6d515479e8d3006041a34f15b526">getBytes</a>(o, <span class="keyword">sizeof</span>(Elf64_Phdr), <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header.html#a25865997e5c358b60ff630a68494c89c">entry</a>);
<a name="l00896"></a>00896         }
<a name="l00897"></a>00897 
<a name="l00898"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a66eba7a23760b1a7955dc3821163a67e">00898</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a66eba7a23760b1a7955dc3821163a67e">ProgramHeader32::getVaddr</a>(){
<a name="l00899"></a>00899             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a4c6cc2a3e7348952337e55693edf021b">PHDR32_ENTRY</a>-&gt;p_vaddr;
<a name="l00900"></a>00900         }
<a name="l00901"></a>00901 
<a name="l00902"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a3b8ed64a54eb47450dff7be0ee28817b">00902</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a3b8ed64a54eb47450dff7be0ee28817b">ProgramHeader64::getVaddr</a>(){
<a name="l00903"></a>00903             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a2520b959decfd5851eb04a64f47f06fa">PHDR64_ENTRY</a>-&gt;p_vaddr;
<a name="l00904"></a>00904         }
<a name="l00905"></a>00905 
<a name="l00906"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a00042a0b2d817185d053d0647956261f">00906</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a00042a0b2d817185d053d0647956261f">ProgramHeader32::getPaddr</a>(){
<a name="l00907"></a>00907             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a4c6cc2a3e7348952337e55693edf021b">PHDR32_ENTRY</a>-&gt;p_paddr;
<a name="l00908"></a>00908         }
<a name="l00909"></a>00909 
<a name="l00910"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a7e1bc27b844418b80f56c458a49797a6">00910</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a7e1bc27b844418b80f56c458a49797a6">ProgramHeader64::getPaddr</a>(){
<a name="l00911"></a>00911             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a2520b959decfd5851eb04a64f47f06fa">PHDR64_ENTRY</a>-&gt;p_paddr;
<a name="l00912"></a>00912         }
<a name="l00913"></a>00913 
<a name="l00914"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a8eac270d2eff779a2f7de736f0b77113">00914</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a8eac270d2eff779a2f7de736f0b77113">ProgramHeader32::getFSize</a>(){
<a name="l00915"></a>00915             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a4c6cc2a3e7348952337e55693edf021b">PHDR32_ENTRY</a>-&gt;p_filesz;
<a name="l00916"></a>00916         }
<a name="l00917"></a>00917 
<a name="l00918"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a04e7b5890ccc7c01d23e221fbfc44708">00918</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a04e7b5890ccc7c01d23e221fbfc44708">ProgramHeader64::getFSize</a>(){
<a name="l00919"></a>00919             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a2520b959decfd5851eb04a64f47f06fa">PHDR64_ENTRY</a>-&gt;p_filesz;
<a name="l00920"></a>00920         }
<a name="l00921"></a>00921 
<a name="l00922"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a81d8e54c74130cc27f72ceb27a2044af">00922</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a81d8e54c74130cc27f72ceb27a2044af">ProgramHeader32::getMSize</a>(){
<a name="l00923"></a>00923             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a4c6cc2a3e7348952337e55693edf021b">PHDR32_ENTRY</a>-&gt;p_memsz;
<a name="l00924"></a>00924         }
<a name="l00925"></a>00925 
<a name="l00926"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a821b37a8d6ebdf7fea555e7a4434eac2">00926</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a821b37a8d6ebdf7fea555e7a4434eac2">ProgramHeader64::getMSize</a>(){
<a name="l00927"></a>00927             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a2520b959decfd5851eb04a64f47f06fa">PHDR64_ENTRY</a>-&gt;p_memsz;
<a name="l00928"></a>00928         }
<a name="l00929"></a>00929 
<a name="l00930"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#ac97782a148e1eacf90b38720e535cbef">00930</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#ac97782a148e1eacf90b38720e535cbef">ProgramHeader32::getFlags</a>(){
<a name="l00931"></a>00931             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a4c6cc2a3e7348952337e55693edf021b">PHDR32_ENTRY</a>-&gt;p_flags;
<a name="l00932"></a>00932         }
<a name="l00933"></a>00933 
<a name="l00934"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a9f12ad0de269ad3c5c7f2fc52f72fc5a">00934</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a9f12ad0de269ad3c5c7f2fc52f72fc5a">ProgramHeader64::getFlags</a>(){
<a name="l00935"></a>00935             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a2520b959decfd5851eb04a64f47f06fa">PHDR64_ENTRY</a>-&gt;p_flags;
<a name="l00936"></a>00936         }
<a name="l00937"></a>00937 
<a name="l00938"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a8b50e70db41f7b4f646f1ab2b54c227a">00938</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a8b50e70db41f7b4f646f1ab2b54c227a">ProgramHeader32::getAlignment</a>(){
<a name="l00939"></a>00939             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a4c6cc2a3e7348952337e55693edf021b">PHDR32_ENTRY</a>-&gt;p_align;
<a name="l00940"></a>00940         }
<a name="l00941"></a>00941 
<a name="l00942"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a68a761d44891ce538049b04236fe2a9c">00942</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a68a761d44891ce538049b04236fe2a9c">ProgramHeader64::getAlignment</a>(){
<a name="l00943"></a>00943             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a2520b959decfd5851eb04a64f47f06fa">PHDR64_ENTRY</a>-&gt;p_align;
<a name="l00944"></a>00944         }
<a name="l00945"></a>00945 
<a name="l00946"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#af00964314bdbe0342ea9ef1ff2a156ab">00946</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#af00964314bdbe0342ea9ef1ff2a156ab">ProgramHeader32::getSegmentType</a>(){
<a name="l00947"></a>00947             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a4c6cc2a3e7348952337e55693edf021b">PHDR32_ENTRY</a>-&gt;p_type;
<a name="l00948"></a>00948         }
<a name="l00949"></a>00949 
<a name="l00950"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a5a35087dbe63d5fdabd5893bb57c38a3">00950</a>         uint32_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#a5a35087dbe63d5fdabd5893bb57c38a3">ProgramHeader64::getSegmentType</a>(){
<a name="l00951"></a>00951             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a2520b959decfd5851eb04a64f47f06fa">PHDR64_ENTRY</a>-&gt;p_type;
<a name="l00952"></a>00952         }
<a name="l00953"></a>00953 
<a name="l00954"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a46bdc77ad9a585e058f0dadcc4e71831">00954</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header32.html#a46bdc77ad9a585e058f0dadcc4e71831">ProgramHeader32::getFOffset</a>(){
<a name="l00955"></a>00955             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a4c6cc2a3e7348952337e55693edf021b">PHDR32_ENTRY</a>-&gt;p_offset;
<a name="l00956"></a>00956         }
<a name="l00957"></a>00957 
<a name="l00958"></a><a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#adde9f4fb75d093fcc7f30d42909f8ef5">00958</a>         uint64_t <a class="code" href="class_e_p_a_x_1_1_elf_1_1_program_header64.html#adde9f4fb75d093fcc7f30d42909f8ef5">ProgramHeader64::getFOffset</a>(){
<a name="l00959"></a>00959             <span class="keywordflow">return</span> <a class="code" href="_elf_binary_8cpp.html#a2520b959decfd5851eb04a64f47f06fa">PHDR64_ENTRY</a>-&gt;p_offset;
<a name="l00960"></a>00960         }
<a name="l00961"></a>00961 
<a name="l00962"></a>00962     } <span class="comment">// namespace Elf</span>
<a name="l00963"></a>00963 
<a name="l00964"></a>00964 } <span class="comment">// namespace EPAX</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 7 2014 09:40:34 for EPAXDeveloperGuide by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
